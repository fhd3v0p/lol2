<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>„ÉÜ„Ç±„ÉÜ„Ç± | URBAN LEGENDS</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono:wght@400&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;700&display=swap');
        
        :root {
            --bg-primary: #0d0d14;
            --bg-secondary: #1a1a24;
            --bg-tertiary: #242438;
            --text-primary: #ff4444;
            --text-secondary: #999;
            --accent-blood: #cc0000;
            --accent-pale: #ffeeee;
            --accent-blue: #4488ff;
            --shadow-red: rgba(204, 0, 0, 0.3);
            --glow-red: rgba(255, 68, 68, 0.4);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(135deg, var(--bg-primary), var(--bg-secondary));
            color: var(--text-primary);
            font-family: 'Share Tech Mono', 'Noto Sans JP', monospace;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* –≠—Ñ—Ñ–µ–∫—Ç —Ü–∞—Ä–∞–ø–∞–Ω–∏—è –∏ –ø–æ–ª–∑–∞–Ω–∏—è */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                repeating-linear-gradient(
                    45deg,
                    transparent,
                    transparent 1px,
                    rgba(204, 0, 0, 0.02) 1px,
                    rgba(204, 0, 0, 0.02) 2px
                );
            animation: scratch 10s linear infinite;
            pointer-events: none;
            z-index: 1;
        }

        @keyframes scratch {
            0% { transform: translateX(0) translateY(0); }
            25% { transform: translateX(2px) translateY(-1px); }
            50% { transform: translateX(-1px) translateY(1px); }
            75% { transform: translateX(1px) translateY(-2px); }
            100% { transform: translateX(0) translateY(0); }
        }

        /* –ó–≤—É–∫–æ–≤—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã "—Ç—ç–∫—ç-—Ç—ç–∫—ç" */
        .teke-sound {
            position: fixed;
            bottom: 20px;
            left: 20px;
            font-size: 14px;
            color: var(--accent-blood);
            opacity: 0;
            animation: tekeSound 3s infinite;
            pointer-events: none;
            z-index: 1000;
        }

        @keyframes tekeSound {
            0%, 90% { opacity: 0; }
            5% { opacity: 1; }
            10% { opacity: 0; }
            15% { opacity: 1; }
            20% { opacity: 0; }
        }

        .phone-container {
            width: 390px;
            height: 750px;
            margin: 20px auto;
            background: linear-gradient(145deg, #2a2a2a, #1a1a1a);
            border: 3px solid #444;
            border-radius: 25px;
            padding: 15px;
            box-shadow: 
                0 0 40px var(--shadow-red),
                inset 0 0 20px rgba(0, 0, 0, 0.7);
            position: relative;
            z-index: 10;
        }

        .screen {
            width: 100%;
            height: 100%;
            background: var(--bg-primary);
            border-radius: 20px;
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .phone-header {
            background: var(--bg-tertiary);
            padding: 12px 16px;
            font-size: 11px;
            border-bottom: 1px solid #333;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .carrier-info {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .signal-strength {
            display: flex;
            gap: 2px;
        }

        .signal-bar {
            width: 3px;
            height: 8px;
            background: var(--text-primary);
            opacity: 0.3;
        }

        .signal-bar.active {
            opacity: 1;
            animation: signalFlicker 2s infinite;
        }

        @keyframes signalFlicker {
            0%, 70% { opacity: 1; }
            85%, 100% { opacity: 0.3; }
        }

        .battery-indicator {
            color: var(--accent-blood);
            animation: batteryDrain 4s infinite;
        }

        @keyframes batteryDrain {
            0%, 60% { opacity: 1; }
            80%, 100% { opacity: 0.4; }
        }

        .content-area {
            flex: 1;
            padding: 20px 16px;
            overflow-y: auto;
            position: relative;
        }

        .legend-selector {
            display: grid;
            gap: 15px;
            margin: 20px 0;
        }

        .legend-card {
            background: linear-gradient(135deg, var(--bg-secondary), var(--bg-tertiary));
            border: 2px solid #444;
            border-radius: 12px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.4s ease;
            position: relative;
            overflow: hidden;
        }

        .legend-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, var(--glow-red), transparent);
            transition: left 0.6s;
        }

        .legend-card:hover::before {
            left: 100%;
        }

        .legend-card:hover {
            border-color: var(--text-primary);
            box-shadow: 0 0 25px var(--glow-red);
            transform: translateY(-3px);
        }

        .legend-card.active {
            border-color: var(--accent-blood);
            background: linear-gradient(135deg, rgba(204, 0, 0, 0.1), var(--bg-tertiary));
        }

        .legend-title {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 8px;
            color: var(--text-primary);
        }

        .legend-subtitle {
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: 12px;
        }

        .legend-description {
            font-size: 11px;
            line-height: 1.4;
            color: var(--accent-pale);
        }

        .chapter-container {
            animation: slideIn 0.6s ease-out;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .chapter-title {
            text-align: center;
            margin-bottom: 25px;
        }

        .chapter-title h2 {
            font-size: 18px;
            color: var(--accent-blood);
            margin-bottom: 8px;
        }

        .chapter-title .subtitle {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .story-log {
            background: rgba(255, 68, 68, 0.05);
            border: 1px solid rgba(255, 68, 68, 0.2);
            border-radius: 10px;
            padding: 16px;
            margin: 16px 0;
            position: relative;
        }

        .story-log.corrupted {
            background: rgba(204, 0, 0, 0.1);
            border-color: var(--accent-blood);
            animation: logCorruption 0.5s ease-out;
        }

        @keyframes logCorruption {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-2px); }
            75% { transform: translateX(2px); }
        }

        .story-log.phone-call {
            background: rgba(68, 136, 255, 0.1);
            border-color: var(--accent-blue);
        }

        .story-log.bathroom {
            background: rgba(255, 238, 238, 0.1);
            border-color: var(--accent-pale);
        }

        .log-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            font-size: 10px;
            color: var(--text-secondary);
        }

        .log-content {
            font-size: 13px;
            line-height: 1.5;
            margin-bottom: 8px;
        }

        .log-timestamp {
            font-size: 9px;
            color: var(--text-secondary);
            text-align: right;
            opacity: 0.7;
        }

        .japanese-text {
            font-family: 'Noto Sans JP', sans-serif;
            font-weight: 300;
        }

        .japanese-symbol {
            font-family: 'Noto Sans JP', sans-serif;
            font-size: 22px;
            color: var(--accent-blood);
            display: inline-block;
            margin-right: 8px;
            animation: symbolPulse 4s infinite;
        }

        @keyframes symbolPulse {
            0%, 100% { 
                text-shadow: 0 0 10px var(--accent-blood);
                transform: scale(1);
            }
            50% { 
                text-shadow: 0 0 20px var(--accent-blood), 0 0 30px var(--accent-blood);
                transform: scale(1.1);
            }
        }

        .interactive-element {
            background: var(--bg-secondary);
            border: 1px solid #555;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            text-align: center;
        }

        .mini-game {
            background: linear-gradient(135deg, var(--bg-secondary), var(--bg-tertiary));
            border: 2px solid #666;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .game-title {
            color: var(--accent-blood);
            font-size: 14px;
            margin-bottom: 15px;
            text-align: center;
        }

        .choice-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin: 15px 0;
        }

        .choice-button {
            padding: 15px 12px;
            background: linear-gradient(135deg, var(--bg-secondary), var(--bg-tertiary));
            border: 1px solid #555;
            border-radius: 8px;
            color: var(--text-primary);
            font-family: inherit;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .choice-button:hover {
            border-color: var(--text-primary);
            box-shadow: 0 0 15px var(--glow-red);
            transform: translateY(-2px);
        }

        .choice-button.dangerous {
            border-color: var(--accent-blood);
            background: linear-gradient(135deg, rgba(204, 0, 0, 0.1), var(--bg-tertiary));
        }

        .choice-button.dangerous:hover {
            box-shadow: 0 0 20px rgba(204, 0, 0, 0.5);
        }

        .choice-button.full-width {
            grid-column: span 2;
        }

        .progress-tracker {
            display: flex;
            justify-content: center;
            gap: 12px;
            margin: 20px 0;
        }

        .progress-step {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #444;
            border: 2px solid #666;
            transition: all 0.3s;
        }

        .progress-step.completed {
            background: var(--accent-blood);
            border-color: var(--accent-blood);
            box-shadow: 0 0 10px var(--accent-blood);
        }

        .progress-step.active {
            background: var(--text-primary);
            border-color: var(--text-primary);
            animation: stepPulse 1.5s infinite;
        }

        @keyframes stepPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }

        .fear-meter {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(0, 0, 0, 0.8);
            border: 1px solid #555;
            border-radius: 6px;
            padding: 10px;
            font-size: 10px;
            z-index: 100;
        }

        .fear-bar {
            width: 70px;
            height: 8px;
            background: #333;
            border-radius: 4px;
            margin-top: 5px;
            overflow: hidden;
        }

        .fear-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--text-primary), var(--accent-blood));
            width: 0%;
            transition: width 0.8s ease;
        }

        .choices-container {
            padding: 16px;
            border-top: 1px solid #444;
            background: var(--bg-tertiary);
        }

        .interaction-hint {
            text-align: center;
            color: var(--accent-blood);
            font-size: 11px;
            margin-bottom: 12px;
            animation: hintPulse 2s infinite;
        }

        @keyframes hintPulse {
            0%, 100% { opacity: 0.6; }
            50% { opacity: 1; }
        }

        .crawling-animation {
            position: absolute;
            width: 40px;
            height: 20px;
            background: var(--accent-blood);
            border-radius: 50% 50% 0 0;
            opacity: 0.2;
            animation: crawl 6s linear infinite;
        }

        @keyframes crawl {
            0% { left: -40px; bottom: 10px; }
            50% { left: 50%; bottom: 15px; transform: scaleX(-1); }
            100% { left: calc(100% + 40px); bottom: 10px; transform: scaleX(-1); }
        }

        .phone-vibration {
            animation: phoneVibrate 0.1s infinite;
        }

        @keyframes phoneVibrate {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-1px); }
            75% { transform: translateX(1px); }
        }

        .hidden { display: none; }

        /* –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–π –ª–µ–≥–µ–Ω–¥—ã */
        .teke-teke-effect {
            background: linear-gradient(45deg, 
                rgba(204, 0, 0, 0.1) 0%, 
                transparent 50%, 
                rgba(204, 0, 0, 0.1) 100%);
        }

        .okiku-effect {
            background: radial-gradient(circle at center, 
                rgba(255, 238, 238, 0.1) 0%, 
                transparent 70%);
        }

        .phone-call-effect {
            background: linear-gradient(180deg, 
                rgba(68, 136, 255, 0.1) 0%, 
                transparent 100%);
        }
    </style>
</head>
<body>
    <div class="teke-sound" id="tekeSound">„ÉÜ„Ç±„ÉÜ„Ç±... „ÉÜ„Ç±„ÉÜ„Ç±...</div>
    
    <div class="fear-meter">
        <div class="japanese-text">ÊÅêÊÄñÂ∫¶</div>
        <div class="fear-bar">
            <div class="fear-fill" id="fearFill"></div>
        </div>
    </div>

    <div class="phone-container" id="phoneContainer">
        <div class="screen">
            <div class="phone-header">
                <div class="carrier-info">
                    <div class="signal-strength">
                        <div class="signal-bar active"></div>
                        <div class="signal-bar active"></div>
                        <div class="signal-bar"></div>
                        <div class="signal-bar"></div>
                    </div>
                    <span class="japanese-text" style="font-size: 10px;">DoCoMo</span>
                </div>
                <div class="battery-indicator">05% ‚ö†Ô∏è</div>
            </div>

            <div id="gameContent" class="content-area">
                <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>

            <div id="choicesContainer" class="choices-container">
                <div class="interaction-hint japanese-text">„Ç∑„Çπ„ÉÜ„É†Ë™≠„ÅøËæº„Åø‰∏≠...</div>
            </div>
        </div>
    </div>

    <script>
        const tg = window.Telegram?.WebApp;
        if (tg) {
            tg.ready();
            tg.expand();
            tg.setHeaderColor('#0d0d14');
            tg.setBackgroundColor('#0d0d14');
        }

        class TokyoLegendsGame {
            constructor() {
                this.gameContent = document.getElementById('gameContent');
                this.choicesContainer = document.getElementById('choicesContainer');
                this.fearLevel = 0;
                this.gameState = {
                    currentLegend: null,
                    chapter: 0,
                    choices: [],
                    playerName: '',
                    completedLegends: [],
                    secretsFound: [],
                    jumpScares: 0
                };

                this.legends = {
                    teke_teke: {
                        title: '„ÉÜ„Ç±„ÉÜ„Ç± (–¢—ç–∫—ç-—Ç—ç–∫—ç)',
                        subtitle: '–î–µ–≤—É—à–∫–∞ –±–µ–∑ –Ω–æ–≥',
                        description: '–î—É—Ö —à–∫–æ–ª—å–Ω–∏—Ü—ã, —Ä–∞–∑—Ä–µ–∑–∞–Ω–Ω–æ–π –ø–æ–µ–∑–¥–æ–º, –ø–æ–ª–∑–∞–µ—Ç –Ω–∞ —Ä—É–∫–∞—Ö –ø–æ –∂–µ–ª–µ–∑–Ω–æ–¥–æ—Ä–æ–∂–Ω—ã–º –ø—É—Ç—è–º –∏ –∏–∑–¥–∞–µ—Ç –∑–≤—É–∫ "—Ç—ç–∫—ç-—Ç—ç–∫—ç"',
                        chapters: 4,
                        difficulty: 'extreme'
                    },
                    okiku: {
                        title: '„ÅäËèä„Åï„Çì (–û–∫–∏–∫—É-—Å–∞–Ω)',
                        subtitle: '–î—É—Ö –∏–∑ —Ç—É–∞–ª–µ—Ç–∞',
                        description: '–ü—Ä–∏–∑—Ä–∞–∫ –¥–µ–≤—É—à–∫–∏, —É–±–∏—Ç–æ–π –≤ –º–Ω–æ–≥–æ—ç—Ç–∞–∂–∫–µ, –æ–±–∏—Ç–∞–µ—Ç –≤ –∂–µ–Ω—Å–∫–∏—Ö —Ç—É–∞–ª–µ—Ç–∞—Ö –±–∏–∑–Ω–µ—Å-—Ü–µ–Ω—Ç—Ä–æ–≤ –¢–æ–∫–∏–æ',
                        chapters: 3,
                        difficulty: 'hard'
                    },
                    moshi_moshi: {
                        title: '„ÇÇ„Åó„ÇÇ„Åó (–ú–æ—à–∏-–º–æ—à–∏)',
                        subtitle: '–ó–≤–æ–Ω–∫–∏ —Å —Ç–æ–≥–æ —Å–≤–µ—Ç–∞',
                        description: '–í 03:00 –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –∑–≤–æ–Ω–æ–∫ —Å –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–≥–æ –Ω–æ–º–µ—Ä–∞, –≥–¥–µ —Å–ª—ã—à–∏—à—å —Å–≤–æ–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –≥–æ–ª–æ—Å',
                        chapters: 3,
                        difficulty: 'medium'
                    }
                };

                if (tg?.initDataUnsafe?.user) {
                    this.gameState.playerName = tg.initDataUnsafe.user.first_name || '–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å';
                }

                this.init();
            }

            init() {
                this.showLegendSelector();
            }

            showLegendSelector() {
                this.gameContent.innerHTML = `
                    <div style="text-align: center; margin-bottom: 25px;">
                        <h1 style="font-size: 20px; color: var(--accent-blood); margin-bottom: 10px;">
                            <span class="japanese-symbol">ÊÄñ</span>–ì–û–†–û–î–°–ö–ò–ï –õ–ï–ì–ï–ù–î–´ –¢–û–ö–ò–û
                        </h1>
                        <div style="font-size: 12px; color: var(--text-secondary);">
                            2005 –≥–æ–¥ ‚Ä¢ –í—ã–±–µ—Ä–∏—Ç–µ –∏—Å—Ç–æ—Ä–∏—é –¥–ª—è —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è
                        </div>
                    </div>

                    <div style="background: rgba(204, 0, 0, 0.1); border: 1px solid var(--accent-blood); border-radius: 8px; padding: 15px; margin-bottom: 20px;">
                        <div style="color: var(--accent-blood); font-size: 11px; font-weight: bold; margin-bottom: 8px;">‚ö†Ô∏è –ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–ï</div>
                        <div style="font-size: 10px;">
                            –ù–∞–π–¥–µ–Ω —Ç–µ–ª–µ—Ñ–æ–Ω —Å –∑–∞–ø–∏—Å—è–º–∏ –æ –ø–∞—Ä–∞–Ω–æ—Ä–º–∞–ª—å–Ω—ã—Ö —è–≤–ª–µ–Ω–∏—è—Ö –≤ –¢–æ–∫–∏–æ. 
                            –ö–∞–∂–¥–∞—è –∏—Å—Ç–æ—Ä–∏—è –æ—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –≥–æ—Ä–æ–¥—Å–∫–∏—Ö –ª–µ–≥–µ–Ω–¥–∞—Ö. 
                            –ü—Ä–æ—Å–º–æ—Ç—Ä –Ω–∞ –≤–∞—à —Å—Ç—Ä–∞—Ö –∏ —Ä–∏—Å–∫.
                        </div>
                    </div>

                    <div class="legend-selector">
                        ${Object.entries(this.legends).map(([key, legend]) => `
                            <div class="legend-card" onclick="game.selectLegend('${key}')">
                                <div class="legend-title">${legend.title}</div>
                                <div class="legend-subtitle">${legend.subtitle}</div>
                                <div class="legend-description">${legend.description}</div>
                                <div style="margin-top: 12px; display: flex; justify-content: between; align-items: center;">
                                    <span style="font-size: 10px; color: var(--text-secondary);">
                                        ${legend.chapters} –≥–ª–∞–≤ ‚Ä¢ ${this.getDifficultyLabel(legend.difficulty)}
                                    </span>
                                    ${this.gameState.completedLegends.includes(key) ? 
                                        '<span style="color: var(--accent-blood); font-size: 10px;">‚úì –ü—Ä–æ–π–¥–µ–Ω–æ</span>' : ''}
                                </div>
                            </div>
                        `).join('')}
                    </div>

                    <div style="text-align: center; margin-top: 20px;">
                        <div style="font-size: 10px; color: var(--text-secondary);">
                            –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏–≥—Ä–∞—Ç—å –≤ —Ç–µ–º–Ω–æ—Ç–µ —Å –Ω–∞—É—à–Ω–∏–∫–∞–º–∏
                        </div>
                    </div>
                `;

                this.setChoices([
                    {
                        text: 'üì± –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ',
                        action: () => this.showDeviceInfo(),
                        description: '–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è'
                    }
                ]);
            }

            selectLegend(legendKey) {
                this.gameState.currentLegend = legendKey;
                this.gameState.chapter = 1;
                this.updateFearLevel(10);

                switch(legendKey) {
                    case 'teke_teke':
                        this.startTekeTekeStory();
                        break;
                    case 'okiku':
                        this.startOkikuStory();
                        break;
                    case 'moshi_moshi':
                        this.startMoshiMoshiStory();
                        break;
                }
            }

            // –ò–°–¢–û–†–ò–Ø –¢–≠–ö–≠-–¢–≠–ö–≠
            startTekeTekeStory() {
                this.addCrawlingAnimation();
                this.playTekeSound();
                
                this.gameContent.innerHTML = `
                    <div class="chapter-container teke-teke-effect">
                        <div class="chapter-title">
                            <h2><span class="japanese-symbol">„ÉÜ</span>–¢–≠–ö–≠-–¢–≠–ö–≠</h2>
                            <div class="subtitle">–ì–ª–∞–≤–∞ 1: –°—Ç–∞–Ω—Ü–∏—è –°–∏–±—É—è ‚Ä¢ 23:45</div>
                        </div>

                        <div class="story-log">
                            <div class="log-header">
                                <span>üì± –ó–∞–ø–∏—Å—å –æ—Ç –ª–∏—Ü–∞ –ê—è–∫–∏ –ú–æ—Ä–∏ (Ê£ÆÂΩ©È¶ô)</span>
                                <span>12.10.05</span>
                            </div>
                            <div class="log-content">
                                –í–æ–∑–≤—Ä–∞—â–∞–ª–∞—Å—å –¥–æ–º–æ–π –ø–æ—Å–ª–µ–¥–Ω–∏–º –ø–æ–µ–∑–¥–æ–º. –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –ø—É—Å—Ç–∞—è, —Ç–æ–ª—å–∫–æ —è –∏ –µ—â–µ –ø–∞—Ä–∞ —á–µ–ª–æ–≤–µ–∫.
                                <br><br>
                                –í–¥—Ä—É–≥ —É—Å–ª—ã—à–∞–ª–∞ —Å—Ç—Ä–∞–Ω–Ω—ã–π –∑–≤—É–∫ —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã –ø—É—Ç–µ–π: "—Ç—ç–∫—ç-—Ç—ç–∫—ç... —Ç—ç–∫—ç-—Ç—ç–∫—ç..."
                                <br><br>
                                –ö–∞–∫ –±—É–¥—Ç–æ –∫—Ç–æ-—Ç–æ —Å–∫—Ä–µ–±–µ—Ç —Ä—É–∫–∞–º–∏ –ø–æ –±–µ—Ç–æ–Ω—É.
                            </div>
                        </div>

                        <div class="interactive-element">
                            <div style="color: var(--accent-blood); margin-bottom: 15px;">
                                üéÆ –ß—Ç–æ –≤—ã —Å–ª—ã—à–∏—Ç–µ –≤ –Ω–∞—É—à–Ω–∏–∫–∞—Ö?
                            </div>
                            <div class="choice-grid">
                                <button class="choice-button" onclick="game.tekeChoice('sound1')">
                                    üîä –¶–∞—Ä–∞–ø–∞–Ω–∏–µ –ø–æ –º–µ—Ç–∞–ª–ª—É
                                </button>
                                <button class="choice-button" onclick="game.tekeChoice('sound2')">
                                    üë• –®–µ–ø–æ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≥–æ–ª–æ—Å–æ–≤
                                </button>
                                <button class="choice-button" onclick="game.tekeChoice('sound3')">
                                    üöÇ –ü—Ä–∏–±–ª–∏–∂–∞—é—â–∏–π—Å—è –ø–æ–µ–∑–¥
                                </button>
                                <button class="choice-button" onclick="game.tekeChoice('sound4')">
                                    üíÄ –¢—ç–∫—ç-—Ç—ç–∫—ç... —Ç—ç–∫—ç-—Ç—ç–∫—ç...
                                </button>
                            </div>
                        </div>

                        <div class="progress-tracker">
                            <div class="progress-step active"></div>
                            <div class="progress-step"></div>
                            <div class="progress-step"></div>
                            <div class="progress-step"></div>
                        </div>
                    </div>
                `;

                this.setChoices([
                    {
                        text: '‚è≥ –í—ã–±–µ—Ä–∏—Ç–µ –∑–≤—É–∫ –≤ –º–∏–Ω–∏-–∏–≥—Ä–µ –≤—ã—à–µ',
                        action: () => {},
                        description: '–°–Ω–∞—á–∞–ª–∞ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç–µ, —á—Ç–æ —Å–ª—ã—à–∏—Ç–µ'
                    }
                ]);
            }

            tekeChoice(choice) {
                if (choice === 'sound4') {
                    this.updateFearLevel(25);
                    this.tekeChapter2();
                } else {
                    this.updateFearLevel(15);
                    this.showJumpScare('–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ! –¢—ç–∫—ç-—Ç—ç–∫—ç —É–∂–µ —Ä—è–¥–æ–º!');
                    setTimeout(() => this.tekeChapter2(), 2000);
                }
            }

            tekeChapter2() {
                this.gameState.chapter = 2;
                this.addCrawlingAnimation();
                
                this.gameContent.innerHTML = `
                    <div class="chapter-container teke-teke-effect">
                        <div class="chapter-title">
                            <h2><span class="japanese-symbol">ÈÄô</span>–ü–û–õ–ó–£–©–ê–Ø –¢–ï–ù–¨</h2>
                            <div class="subtitle">–ì–ª–∞–≤–∞ 2: –ñ–µ–ª–µ–∑–Ω–æ–¥–æ—Ä–æ–∂–Ω—ã–µ –ø—É—Ç–∏ ‚Ä¢ 00:10</div>
                        </div>

                        <div class="story-log corrupted">
                            <div class="log-header">
                                <span>üì± –≠–∫—Å—Ç—Ä–µ–Ω–Ω–∞—è –∑–∞–ø–∏—Å—å ‚Ä¢ –ê—è–∫–∏</span>
                                <span>12.10.05</span>
                            </div>
                            <div class="log-content">
                                –Ø —Å–ø—É—Å—Ç–∏–ª–∞—Å—å –∫ –ø—É—Ç—è–º –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å, —á—Ç–æ —Ç–∞–º. –û–®–ò–ë–ö–ê!
                                <br><br>
                                –ú–µ–∂–¥—É —Ä–µ–ª—å—Å–∞–º–∏... –¥–µ–≤—É—à–∫–∞. –ò–ª–∏ —Ç–æ, —á—Ç–æ –æ—Ç –Ω–µ—ë –æ—Å—Ç–∞–ª–æ—Å—å. 
                                –í–µ—Ä—Ö–Ω—è—è –ø–æ–ª–æ–≤–∏–Ω–∞ —Ç–µ–ª–∞ –ø–æ–ª–∑—ë—Ç –Ω–∞ —Ä—É–∫–∞—Ö.
                                <br><br>
                                <span style="color: var(--accent-blood);">–ï—ë –Ω–æ–≥–∏ –æ—Ç—Ä–µ–∑–∞–Ω—ã –Ω–∞ —É—Ä–æ–≤–Ω–µ —Ç–∞–ª–∏–∏.</span>
                                <br><br>
                                –û–Ω–∞ –∑–∞–º–µ—Ç–∏–ª–∞ –º–µ–Ω—è. –ü–æ–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç—Å—è. –£–ª—ã–±–∞–µ—Ç—Å—è...
                            </div>
                        </div>

                        <div class="mini-game">
                            <div class="game-title">‚ö° –†–ï–ê–ö–¶–ò–Ø: –¢—ç–∫—ç-—Ç—ç–∫—ç –ø—Ä–∏–±–ª–∏–∂–∞–µ—Ç—Å—è!</div>
                            <div style="position: relative; height: 80px; background: var(--bg-tertiary); border-radius: 8px; margin: 15px 0; overflow: hidden;">
                                <div id="tekeSprite" style="position: absolute; width: 50px; height: 30px; background: var(--accent-blood); left: 0; top: 25px; border-radius: 50% 50% 0 0; transition: left 3s linear;">
                                    <div style="position: absolute; top: 5px; left: 10px; width: 6px; height: 6px; background: #fff; border-radius: 50%;"></div>
                                    <div style="position: absolute; top: 5px; right: 10px; width: 6px; height: 6px; background: #fff; border-radius: 50%;"></div>
                                </div>
                                <div style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); font-size: 24px;">üèÉ‚Äç‚ôÄÔ∏è</div>
                            </div>
                            <div style="display: flex; gap: 10px;">
                                <button class="choice-button" onclick="game.tekeReaction('run')" style="flex: 1;">
                                    üèÉ‚Äç‚ôÄÔ∏è –ë–ï–ñ–ê–¢–¨!
                                </button>
                                <button class="choice-button dangerous" onclick="game.tekeReaction('look')" style="flex: 1;">
                                    üëÄ –°–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ –Ω–µ—ë
                                </button>
                            </div>
                            <div id="reactionResult" style="text-align: center; margin-top: 10px; font-size: 11px;"></div>
                        </div>

                        <div class="progress-tracker">
                            <div class="progress-step completed"></div>
                            <div class="progress-step active"></div>
                            <div class="progress-step"></div>
                            <div class="progress-step"></div>
                        </div>
                    </div>
                `;

                // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏—è
                setTimeout(() => {
                    const sprite = document.getElementById('tekeSprite');
                    if (sprite) sprite.style.left = 'calc(100% - 60px)';
                }, 500);

                this.setChoices([
                    {
                        text: '‚è≥ –ü—Ä–∏–Ω–∏–º–∞–π—Ç–µ —Ä–µ—à–µ–Ω–∏–µ –±—ã—Å—Ç—Ä–æ!',
                        action: () => {},
                        description: '–¢—ç–∫—ç-—Ç—ç–∫—ç –ø—Ä–∏–±–ª–∏–∂–∞–µ—Ç—Å—è...'
                    }
                ]);
            }

            tekeReaction(action) {
                const result = document.getElementById('reactionResult');
                
                if (action === 'run') {
                    result.textContent = '‚úÖ –í—ã —É–±–µ–∂–∞–ª–∏! –ù–æ —Ç—ç–∫—ç-—Ç—ç–∫—ç –∑–∞–ø–æ–º–Ω–∏–ª–∞ –≤–∞—Å...';
                    result.style.color = 'var(--text-primary)';
                    this.updateFearLevel(40);
                    setTimeout(() => this.tekeChapter3(), 2000);
                } else {
                    result.textContent = '‚ùå –í—ã –ø–æ—Å–º–æ—Ç—Ä–µ–ª–∏ –µ–π –≤ –≥–ª–∞–∑–∞... –¢–µ–ø–µ—Ä—å –æ–Ω–∞ –±—É–¥–µ—Ç –ø—Ä–µ—Å–ª–µ–¥–æ–≤–∞—Ç—å –≤–∞—Å –≤–µ—á–Ω–æ!';
                    result.style.color = 'var(--accent-blood)';
                    this.updateFearLevel(60);
                    this.showJumpScare('–¢—ç–∫—ç-—Ç—ç–∫—ç: "–¢–µ–ø–µ—Ä—å —Ç—ã –º–æ—è..."');
                    setTimeout(() => this.tekeChapter3(), 3000);
                }
            }

            tekeChapter3() {
                this.gameState.chapter = 3;
                
                this.gameContent.innerHTML = `
                    <div class="chapter-container">
                        <div class="chapter-title">
                            <h2><span class="japanese-symbol">ÁµÇ</span>–ù–ï–ò–ó–ë–ï–ñ–ù–ê–Ø –°–£–î–¨–ë–ê</h2>
                            <div class="subtitle">–ì–ª–∞–≤–∞ 3: –í–∞—à–∞ –∫–≤–∞—Ä—Ç–∏—Ä–∞ ‚Ä¢ 03:00</div>
                        </div>

                        <div class="story-log corrupted">
                            <div class="log-header">
                                <span>üì± –ü–æ—Å–ª–µ–¥–Ω—è—è –∑–∞–ø–∏—Å—å ‚Ä¢ –ê—è–∫–∏</span>
                                <span>13.10.05</span>
                            </div>
                            <div class="log-content">
                                –Ø –¥–æ–º–∞, –Ω–æ —á—É–≤—Å—Ç–≤—É—é, —á—Ç–æ –æ–Ω–∞ —Å–ª–µ–¥—É–µ—Ç –∑–∞ –º–Ω–æ–π. 
                                <br><br>
                                –ö–∞–∂–¥—É—é –Ω–æ—á—å —Å–ª—ã—à—É "—Ç—ç–∫—ç-—Ç—ç–∫—ç" –ø–æ–¥ –æ–∫–Ω–∞–º–∏. –û–Ω–∞ –ø–æ–ª–∑—ë—Ç –ø–æ —Å—Ç–µ–Ω–∞–º –∑–¥–∞–Ω–∏—è.
                                <br><br>
                                –°–µ–≥–æ–¥–Ω—è –Ω–∞—à–ª–∞ —Ü–∞—Ä–∞–ø–∏–Ω—ã –Ω–∞ –¥–≤–µ—Ä–∏. –î–ª–∏–Ω–Ω—ã–µ, –æ—Ç –Ω–æ–≥—Ç–µ–π.
                                <br><br>
                                <span style="color: var(--accent-blood);">–û–Ω–∞ –ø–æ–¥–Ω–∏–º–∞–µ—Ç—Å—è –ø–æ –ª–µ—Å—Ç–Ω–∏—Ü–µ. –ö –º–æ–µ–º—É —ç—Ç–∞–∂—É...</span>
                            </div>
                        </div>

                        <div class="story-log">
                            <div class="log-content" style="text-align: center; font-style: italic;">
                                <span style="color: var(--accent-blood); font-size: 16px;">
                                    "–¢—ç–∫—ç-—Ç—ç–∫—ç... —Ç—ç–∫—ç-—Ç—ç–∫—ç..."
                                </span>
                                <br><br>
                                <span style="font-size: 11px; color: var(--text-secondary);">
                                    [–°–¢–£–ö –í –î–í–ï–†–¨]
                                </span>
                            </div>
                        </div>

                        <div class="progress-tracker">
                            <div class="progress-step completed"></div>
                            <div class="progress-step completed"></div>
                            <div class="progress-step completed"></div>
                            <div class="progress-step active"></div>
                        </div>
                    </div>
                `;

                this.updateFearLevel(80);
                
                this.setChoices([
                    {
                        text: 'üö™ –û—Ç–∫—Ä—ã—Ç—å –¥–≤–µ—Ä—å',
                        action: () => this.tekeEnding('open'),
                        description: '–í—Å—Ç—Ä–µ—Ç–∏—Ç—å—Å—è —Å —Å—É–¥—å–±–æ–π –ª–∏—Ü–æ–º –∫ –ª–∏—Ü—É',
                        dangerous: true
                    },
                    {
                        text: 'üîá –ù–µ –æ—Ç–≤–µ—á–∞—Ç—å',
                        action: () => this.tekeEnding('hide'),
                        description: '–ü–æ–ø—ã—Ç–∞—Ç—å—Å—è —Å–ø—Ä—è—Ç–∞—Ç—å—Å—è'
                    },
                    {
                        text: 'üìû –ü–æ–∑–≤–æ–Ω–∏—Ç—å –≤ –ø–æ–ª–∏—Ü–∏—é',
                        action: () => this.tekeEnding('police'),
                        description: '–û–±—Ä–∞—Ç–∏—Ç—å—Å—è –∑–∞ –ø–æ–º–æ—â—å—é'
                    },
                    {
                        text: 'üèÉ‚Äç‚ôÄÔ∏è –£–±–µ–∂–∞—Ç—å —á–µ—Ä–µ–∑ –æ–∫–Ω–æ',
                        action: () => this.tekeEnding('escape'),
                        description: '–≠–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–π –ø–æ–±–µ–≥',
                        dangerous: true
                    }
                ]);
            }

            tekeEnding(choice) {
                this.updateFearLevel(100);
                this.gameState.completedLegends.push('teke_teke');
                
                let endingContent = '';
                
                switch(choice) {
                    case 'open':
                        endingContent = `
                            <div class="story-log corrupted">
                                <div class="log-content">
                                    –í—ã –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç–µ –¥–≤–µ—Ä—å. –¢—ç–∫—ç-—Ç—ç–∫—ç –ø–æ–ª–∑—ë—Ç –∫ –≤–∞–º –ø–æ –ø–æ–ª—É –∫–æ—Ä–∏–¥–æ—Ä–∞.
                                    <br><br>
                                    "–ù–∞–∫–æ–Ω–µ—Ü-—Ç–æ –º—ã –≤—Å—Ç—Ä–µ—Ç–∏–ª–∏—Å—å," - —à–µ–ø—á–µ—Ç –æ–Ω–∞. "–¢–µ–ø–µ—Ä—å —è –Ω–µ –æ–¥–∏–Ω–æ–∫–∞..."
                                    <br><br>
                                    <span style="color: var(--accent-blood);">
                                        –í–∞—à–∏ –Ω–æ–≥–∏ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è —Ö–æ–ª–æ–¥–Ω—ã–º–∏. –û—á–µ–Ω—å —Ö–æ–ª–æ–¥–Ω—ã–º–∏...
                                    </span>
                                </div>
                            </div>
                        `;
                        break;
                    case 'hide':
                        endingContent = `
                            <div class="story-log">
                                <div class="log-content">
                                    –í—ã –º–æ–ª—á–∏—Ç–µ. –°—Ç—É–∫ –ø—Ä–µ–∫—Ä–∞—â–∞–µ—Ç—Å—è.
                                    <br><br>
                                    –¢–∏—à–∏–Ω–∞ –¥–ª–∏—Ç—Å—è —á–∞—Å. –î–≤–∞. –ö —É—Ç—Ä—É –æ–Ω–∞ –∏—Å—á–µ–∑–∞–µ—Ç.
                                    <br><br>
                                    –ù–æ —Ç–µ–ø–µ—Ä—å –≤—ã –∑–Ω–∞–µ—Ç–µ - –æ–Ω–∞ –≤–µ—Ä–Ω—ë—Ç—Å—è. –ö–∞–∂–¥—É—é –Ω–æ—á—å –≤ 03:00...
                                </div>
                            </div>
                        `;
                        break;
                    case 'police':
                        endingContent = `
                            <div class="story-log">
                                <div class="log-content">
                                    –ü–æ–ª–∏—Ü–∏—è –ø—Ä–∏–µ–∑–∂–∞–µ—Ç, –Ω–æ –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç –Ω–∏–∫–æ–≥–æ. 
                                    <br><br>
                                    "–í–æ–∑–º–æ–∂–Ω–æ, —ç—Ç–æ —Ä–æ–∑—ã–≥—Ä—ã—à," - –≥–æ–≤–æ—Ä—è—Ç –æ–Ω–∏.
                                    <br><br>
                                    –ù–æ –Ω–∞ –¥–≤–µ—Ä–∏ –æ—Å—Ç–∞–ª–∏—Å—å —Ü–∞—Ä–∞–ø–∏–Ω—ã. –û—á–µ–Ω—å –≥–ª—É–±–æ–∫–∏–µ —Ü–∞—Ä–∞–ø–∏–Ω—ã...
                                </div>
                            </div>
                        `;
                        break;
                    case 'escape':
                        endingContent = `
                            <div class="story-log corrupted">
                                <div class="log-content">
                                    –í—ã –≤—ã–ø—Ä—ã–≥–∏–≤–∞–µ—Ç–µ –≤ –æ–∫–Ω–æ. –ü–∞–¥–µ–Ω–∏–µ —Å —Ç—Ä–µ—Ç—å–µ–≥–æ —ç—Ç–∞–∂–∞...
                                    <br><br>
                                    –í–∞—à–∏ –Ω–æ–≥–∏ —Å–ª–æ–º–∞–Ω—ã. –í—ã –ø–æ–ª–∑—ë—Ç–µ –ø–æ –∞—Å—Ñ–∞–ª—å—Ç—É –Ω–∞ —Ä—É–∫–∞—Ö.
                                    <br><br>
                                    <span style="color: var(--accent-blood);">
                                        "–¢—ç–∫—ç-—Ç—ç–∫—ç... —Ç—ç–∫—ç-—Ç—ç–∫—ç..." - —Ç–µ–ø–µ—Ä—å —ç—Ç–æ—Ç –∑–≤—É–∫ –∏–∑–¥–∞—ë—Ç–µ –≤—ã...
                                    </span>
                                </div>
                            </div>
                        `;
                        break;
                }

                this.gameContent.innerHTML = `
                    <div class="chapter-container">
                        <div class="chapter-title">
                            <h2><span class="japanese-symbol">ÁµÇ</span>–§–ò–ù–ê–õ</h2>
                            <div class="subtitle">–ò—Å—Ç–æ—Ä–∏—è –¢—ç–∫—ç-—Ç—ç–∫—ç –∑–∞–≤–µ—Ä—à–µ–Ω–∞</div>
                        </div>

                        ${endingContent}

                        <div style="text-align: center; margin: 20px 0; padding: 15px; background: rgba(255, 68, 68, 0.1); border-radius: 8px;">
                            <div style="color: var(--text-primary); margin-bottom: 10px;">
                                üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê –ü–†–û–•–û–ñ–î–ï–ù–ò–Ø
                            </div>
                            <div style="font-size: 11px; color: var(--text-secondary);">
                                –£—Ä–æ–≤–µ–Ω—å —Å—Ç—Ä–∞—Ö–∞: ${this.fearLevel}%<br>
                                –ö–æ–Ω—Ü–æ–≤–∫–∞: ${this.getEndingName(choice)}<br>
                                –õ–µ–≥–µ–Ω–¥ –ø—Ä–æ–π–¥–µ–Ω–æ: ${this.gameState.completedLegends.length}/3
                            </div>
                        </div>

                        <div class="progress-tracker">
                            <div class="progress-step completed"></div>
                            <div class="progress-step completed"></div>
                            <div class="progress-step completed"></div>
                            <div class="progress-step completed"></div>
                        </div>
                    </div>
                `;

                this.setChoices([
                    {
                        text: 'üëª –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –¥—Ä—É–≥—É—é –ª–µ–≥–µ–Ω–¥—É',
                        action: () => this.showLegendSelector(),
                        description: '–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –≤—ã–±–æ—Ä—É –∏—Å—Ç–æ—Ä–∏–π'
                    },
                    {
                        text: 'üîÑ –ü—Ä–æ–π—Ç–∏ –¢—ç–∫—ç-—Ç—ç–∫—ç –∑–∞–Ω–æ–≤–æ',
                        action: () => this.startTekeTekeStory(),
                        description: '–ò–∑–º–µ–Ω–∏—Ç—å —Å–≤–æ—é —Å—É–¥—å–±—É'
                    },
                    {
                        text: 'üéì –ò–∑—É—á–∏—Ç—å —Ç–∞—Ç—É-–º–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ',
                        action: () => this.showCoursesOverview(),
                        description: '–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ —Å–æ–∑–∏–¥–∞—Ç–µ–ª—å–Ω–æ–µ –∏—Å–∫—É—Å—Å—Ç–≤–æ'
                    }
                ]);
            }

            // –ò–°–¢–û–†–ò–Ø –û–ö–ò–ö–£-–°–ê–ù
            startOkikuStory() {
                this.gameContent.innerHTML = `
                    <div class="chapter-container okiku-effect">
                        <div class="chapter-title">
                            <h2><span class="japanese-symbol">Ëèä</span>–û–ö–ò–ö–£-–°–ê–ù</h2>
                            <div class="subtitle">–ì–ª–∞–≤–∞ 1: –ë–∏–∑–Ω–µ—Å-—Ü–µ–Ω—Ç—Ä –°–∏–Ω–¥–∑—é–∫—É ‚Ä¢ 22:30</div>
                        </div>

                        <div class="story-log bathroom">
                            <div class="log-header">
                                <span>üì± –ó–∞–ø–∏—Å—å —Å–æ—Ç—Ä—É–¥–Ω–∏—Ü—ã –Æ–∫–∏ –°–∞—Ç–æ (‰ΩêËó§Èõ™)</span>
                                <span>25.10.05</span>
                            </div>
                            <div class="log-content">
                                –†–∞–±–æ—Ç–∞—é –¥–æ–ø–æ–∑–¥–Ω–∞ –≤ 47-—ç—Ç–∞–∂–Ω–æ–º –±–∏–∑–Ω–µ—Å-—Ü–µ–Ω—Ç—Ä–µ. –í—Å–µ —Ä–∞–∑–æ—à–ª–∏—Å—å –ø–æ –¥–æ–º–∞–º.
                                <br><br>
                                –ò–¥—É –≤ –∂–µ–Ω—Å–∫–∏–π —Ç—É–∞–ª–µ—Ç –Ω–∞ 30-–º —ç—Ç–∞–∂–µ. –°–ª—ã—à—É –∏–∑ –ø–æ—Å–ª–µ–¥–Ω–µ–π –∫–∞–±–∏–Ω–∫–∏ —Ü–∞—Ä–∞–ø–∞–Ω–∏–µ.
                                <br><br>
                                –ö—Ç–æ-—Ç–æ —Å–∫—Ä–µ–±—ë—Ç –Ω–æ–≥—Ç—è–º–∏ –ø–æ –º–µ—Ç–∞–ª–ª–∏—á–µ—Å–∫–æ–π –ø–µ—Ä–µ–≥–æ—Ä–æ–¥–∫–µ –∏–∑–Ω—É—Ç—Ä–∏...
                            </div>
                        </div>

                        <div class="interactive-element">
                            <div style="color: var(--accent-pale); margin-bottom: 15px;">
                                üö™ –ß—Ç–æ –¥–µ–ª–∞—Ç—å —Å –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∫–∞–±–∏–Ω–∫–æ–π?
                            </div>
                            <div class="choice-grid">
                                <button class="choice-button" onclick="game.okikuChoice('ignore')">
                                    üö∂‚Äç‚ôÄÔ∏è –ü—Ä–æ–∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å
                                </button>
                                <button class="choice-button dangerous" onclick="game.okikuChoice('ask')">
                                    üí¨ –°–ø—Ä–æ—Å–∏—Ç—å "–û–∫–∏–∫—É, —Ç—ã –∑–¥–µ—Å—å?"
                                </button>
                                <button class="choice-button" onclick="game.okikuChoice('call')">
                                    üìû –í—ã–∑–≤–∞—Ç—å –æ—Ö—Ä–∞–Ω—É
                                </button>
                                <button class="choice-button dangerous" onclick="game.okikuChoice('open')">
                                    üîì –û—Ç–∫—Ä—ã—Ç—å –∫–∞–±–∏–Ω–∫—É
                                </button>
                            </div>
                        </div>
                    </div>
                `;

                this.updateFearLevel(20);
                this.setChoices([
                    {
                        text: '‚è≥ –í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ –≤ –º–∏–Ω–∏-–∏–≥—Ä–µ',
                        action: () => {},
                        description: '–ö–∞–∂–¥—ã–π –≤—ã–±–æ—Ä –≤–ª–∏—è–µ—Ç –Ω–∞ —Ä–∞–∑–≤–∏—Ç–∏–µ –∏—Å—Ç–æ—Ä–∏–∏'
                    }
                ]);
            }

            okikuChoice(choice) {
                let nextChapter = '';
                
                switch(choice) {
                    case 'ask':
                        this.updateFearLevel(50);
                        nextChapter = '–í—ã —Ç—Ä–∏–∂–¥—ã —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç–µ "–û–∫–∏–∫—É, —Ç—ã –∑–¥–µ—Å—å?" –¶–∞—Ä–∞–ø–∞–Ω–∏–µ —É—Å–∏–ª–∏–≤–∞–µ—Ç—Å—è...';
                        break;
                    case 'open':
                        this.updateFearLevel(60);
                        nextChapter = '–ö–∞–±–∏–Ω–∫–∞ –ø—É—Å—Ç–∞, –Ω–æ –Ω–∞ —Å—Ç–µ–Ω–∞—Ö —Å–≤–µ–∂–∏–µ —Ü–∞—Ä–∞–ø–∏–Ω—ã –æ—Ç –Ω–æ–≥—Ç–µ–π...';
                        break;
                    case 'ignore':
                        this.updateFearLevel(30);
                        nextChapter = '–í—ã —É—Ö–æ–¥–∏—Ç–µ, –Ω–æ –∑–≤—É–∫ —Å–ª–µ–¥—É–µ—Ç –∑–∞ –≤–∞–º–∏ –ø–æ –∫–æ—Ä–∏–¥–æ—Ä—É...';
                        break;
                    case 'call':
                        this.updateFearLevel(40);
                        nextChapter = '–û—Ö—Ä–∞–Ω–Ω–∏–∫ –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç –Ω–∏–∫–æ–≥–æ, –Ω–æ –∫–∞–º–µ—Ä—ã –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–ª–∏ —Å—Ç—Ä–∞–Ω–Ω—ã–µ –∫–∞–¥—Ä—ã...';
                        break;
                }

                setTimeout(() => this.okikuChapter2(choice), 2000);
            }

            // –ò–°–¢–û–†–ò–Ø –ú–û–®–ò-–ú–û–®–ò
            startMoshiMoshiStory() {
                this.makePhoneVibrate();
                
                this.gameContent.innerHTML = `
                    <div class="chapter-container phone-call-effect">
                        <div class="chapter-title">
                            <h2><span class="japanese-symbol">Èõª</span>–ú–û–®–ò-–ú–û–®–ò</h2>
                            <div class="subtitle">–ì–ª–∞–≤–∞ 1: –ó–≤–æ–Ω–æ–∫ –≤ 03:00</div>
                        </div>

                        <div class="story-log phone-call">
                            <div class="log-header">
                                <span>üì± –ó–∞–ø–∏—Å—å —Å—Ç—É–¥–µ–Ω—Ç–∞ –ö—ç–Ω—Ç–∞ –ò–Ω–æ—É—ç (‰∫ï‰∏äÂÅ•Â§™)</span>
                                <span>08.11.05</span>
                            </div>
                            <div class="log-content">
                                –ü–æ–ª—É—á–∏–ª —Å—Ç—Ä–∞–Ω–Ω–æ–µ –ø–∏—Å—å–º–æ –ø–æ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ—á—Ç–µ. –¶–µ–ø–æ—á–∫–∞: 
                                "–ï—Å–ª–∏ —Ö–æ—á–µ—à—å —É—Å–ª—ã—à–∞—Ç—å —Å–≤–æ–π –≥–æ–ª–æ—Å –∏–∑ –ø—Ä–æ—à–ª–æ–≥–æ, –Ω–µ —Å–ø–∏ –≤ 03:00..."
                                <br><br>
                                –ì–ª—É–ø–æ—Å—Ç–∏, –∫–æ–Ω–µ—á–Ω–æ. –ù–æ —Å–µ–π—á–∞—Å 02:58, –∏ —è –Ω–µ –º–æ–≥—É –∑–∞—Å–Ω—É—Ç—å.
                                <br><br>
                                –¢–µ–ª–µ—Ñ–æ–Ω –ª–µ–∂–∏—Ç —Ä—è–¥–æ–º. –ñ–¥—ë—Ç...
                            </div>
                        </div>

                        <div style="text-align: center; margin: 20px 0; padding: 20px; background: var(--bg-secondary); border-radius: 8px; position: relative;">
                            <div style="font-size: 36px; color: var(--accent-blue); margin-bottom: 10px;" id="digitalClock">03:00</div>
                            <div style="font-size: 12px; color: var(--text-secondary);">–¢–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è</div>
                            <div id="phoneRing" style="position: absolute; top: 10px; right: 10px; font-size: 20px; opacity: 0; animation: phoneRingAnimation 1s infinite;">üìû</div>
                        </div>

                        <div class="interactive-element">
                            <div style="color: var(--accent-blue); margin-bottom: 15px; text-align: center;">
                                üìû –¢–ï–õ–ï–§–û–ù –ó–í–û–ù–ò–¢!
                            </div>
                            <button class="choice-button full-width" onclick="game.answerPhone()" style="font-size: 16px; padding: 20px;">
                                üì± –û–¢–í–ï–¢–ò–¢–¨ –ù–ê –ó–í–û–ù–û–ö
                            </button>
                        </div>
                    </div>
                `;

                // –ê–Ω–∏–º–∞—Ü–∏—è –∑–≤–æ–Ω–∫–∞
                setTimeout(() => {
                    const ring = document.getElementById('phoneRing');
                    if (ring) ring.style.opacity = '1';
                }, 1000);

                this.updateFearLevel(25);
                this.setChoices([
                    {
                        text: 'üìû –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫—É –≤—ã—à–µ –¥–ª—è –æ—Ç–≤–µ—Ç–∞',
                        action: () => {},
                        description: '–ö—Ç–æ-—Ç–æ –∑–≤–æ–Ω–∏—Ç –≤–∞–º –≤ 03:00...'
                    }
                ]);
            }

            answerPhone() {
                this.makePhoneVibrate();
                this.updateFearLevel(70);
                
                this.gameContent.innerHTML = `
                    <div class="chapter-container phone-call-effect">
                        <div class="chapter-title">
                            <h2><span class="japanese-symbol">Â£∞</span>–°–í–û–ô –ì–û–õ–û–°</h2>
                            <div class="subtitle">–ì–ª–∞–≤–∞ 2: –†–∞–∑–≥–æ–≤–æ—Ä —Å —Å–æ–±–æ–π</div>
                        </div>

                        <div class="story-log phone-call">
                            <div class="log-content" style="text-align: center;">
                                <div style="font-size: 14px; margin-bottom: 15px;">üìû –õ–ò–ù–ò–Ø –ê–ö–¢–ò–í–ù–ê</div>
                                <div style="background: var(--bg-primary); padding: 15px; border-radius: 8px; margin: 10px 0;">
                                    <div style="color: var(--accent-blue);">–ù–µ–∑–Ω–∞–∫–æ–º–µ—Ü:</div>
                                    <div style="font-style: italic;">"–ú–æ—à–∏-–º–æ—à–∏... –º–æ—à–∏-–º–æ—à–∏..."</div>
                                </div>
                                <div style="background: var(--bg-primary); padding: 15px; border-radius: 8px; margin: 10px 0;">
                                    <div style="color: var(--text-primary);">–í—ã:</div>
                                    <div>"–ö—Ç–æ —ç—Ç–æ? –û—Ç–∫—É–¥–∞ —É –≤–∞—Å –º–æ–π –Ω–æ–º–µ—Ä?"</div>
                                </div>
                                <div style="background: var(--bg-primary); padding: 15px; border-radius: 8px; margin: 10px 0;">
                                    <div style="color: var(--accent-blood);">–ù–µ–∑–Ω–∞–∫–æ–º–µ—Ü (–≤–∞—à –≥–æ–ª–æ—Å):</div>
                                    <div style="font-style: italic;">"–ö—Ç–æ —ç—Ç–æ? –û—Ç–∫—É–¥–∞ —É –≤–∞—Å –º–æ–π –Ω–æ–º–µ—Ä?"</div>
                                </div>
                            </div>
                        </div>

                        <div style="background: rgba(204, 0, 0, 0.1); padding: 15px; border-radius: 8px; margin: 15px 0; text-align: center;">
                            <div style="color: var(--accent-blood); font-size: 12px; margin-bottom: 8px;">
                                ‚ö†Ô∏è –ê–ù–û–ú–ê–õ–ò–Ø –û–ë–ù–ê–†–£–ñ–ï–ù–ê
                            </div>
                            <div style="font-size: 11px;">
                                –ì–æ–ª–æ—Å –≤ —Ç—Ä—É–±–∫–µ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç –≤–∞—à–∏ —Å–ª–æ–≤–∞ —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π –≤ 3 —Å–µ–∫—É–Ω–¥—ã.
                                –ù–æ –≤—ã –ø—Ä–æ–∏–∑–Ω–æ—Å–∏–ª–∏ –∏—Ö 5 –ª–µ—Ç –Ω–∞–∑–∞–¥...
                            </div>
                        </div>
                    </div>
                `;

                this.setChoices([
                    {
                        text: 'üìû –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Ä–∞–∑–≥–æ–≤–æ—Ä',
                        action: () => this.moshiEnding('continue'),
                        description: '–í—ã—è—Å–Ω–∏—Ç—å –ø—Ä–∞–≤–¥—É –æ –∑–≤–æ–Ω–∫–µ',
                        dangerous: true
                    },
                    {
                        text: 'üìµ –ü–æ–≤–µ—Å–∏—Ç—å —Ç—Ä—É–±–∫—É',
                        action: () => this.moshiEnding('hangup'),
                        description: '–ü—Ä–µ—Ä–≤–∞—Ç—å –∞–Ω–æ–º–∞–ª—å–Ω—É—é —Å–≤—è–∑—å'
                    },
                    {
                        text: 'üìù –ó–∞–ø–∏—Å–∞—Ç—å —Ä–∞–∑–≥–æ–≤–æ—Ä',
                        action: () => this.moshiEnding('record'),
                        description: '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞'
                    }
                ]);
            }

            moshiEnding(choice) {
                this.updateFearLevel(100);
                this.gameState.completedLegends.push('moshi_moshi');
                
                let endingContent = '';
                
                switch(choice) {
                    case 'continue':
                        endingContent = `
                            <div class="story-log phone-call">
                                <div class="log-content">
                                    –í—ã –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç–µ —Ä–∞–∑–≥–æ–≤–æ—Ä —Å —Å–æ–±–æ–π –∏–∑ –ø—Ä–æ—à–ª–æ–≥–æ.
                                    <br><br>
                                    –ì–æ–ª–æ—Å —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞–µ—Ç –æ —Å–æ–±—ã—Ç–∏—è—Ö, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ–∏–∑–æ–π–¥—É—Ç —Å –≤–∞–º–∏.
                                    –û –∫–∞–∂–¥–æ–º –¥–Ω–µ —Å–ª–µ–¥—É—é—â–∏—Ö –ø—è—Ç–∏ –ª–µ—Ç.
                                    <br><br>
                                    <span style="color: var(--accent-blood);">
                                        –ü–æ—Å–ª–µ–¥–Ω–∏–µ —Å–ª–æ–≤–∞: "–ó–∞–≤—Ç—Ä–∞ —Ç—ã —É–º—Ä—ë—à—å –≤ 15:30..."
                                    </span>
                                </div>
                            </div>
                        `;
                        break;
                    case 'hangup':
                        endingContent = `
                            <div class="story-log">
                                <div class="log-content">
                                    –í—ã –∫–ª–∞–¥—ë—Ç–µ —Ç—Ä—É–±–∫—É. –¢–∏—à–∏–Ω–∞.
                                    <br><br>
                                    –ù–æ —Ç–µ–ø–µ—Ä—å –∫–∞–∂–¥—É—é –Ω–æ—á—å –≤ 03:00 —Ç–µ–ª–µ—Ñ–æ–Ω –∑–≤–æ–Ω–∏—Ç.
                                    –ò –∫–∞–∂–¥—ã–π —Ä–∞–∑ –≥–æ–ª–æ—Å —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –≤—Å—ë –±–æ–ª–µ–µ...—Ä–µ–∞–ª—å–Ω—ã–º.
                                </div>
                            </div>
                        `;
                        break;
                    case 'record':
                        endingContent = `
                            <div class="story-log">
                                <div class="log-content">
                                    –ó–∞–ø–∏—Å—å –ø–æ–ª—É—á–∏–ª–∞—Å—å. –ù–æ –ø—Ä–∏ –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–∏ —Å–ª—ã—à–µ–Ω —Ç–æ–ª—å–∫–æ –≤–∞—à –≥–æ–ª–æ—Å.
                                    <br><br>
                                    –í—ã —Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–µ—Ç–µ —Å–∞–º–∏ —Å —Å–æ–±–æ–π. 20 –º–∏–Ω—É—Ç –º–æ–Ω–æ–ª–æ–≥–∞...
                                    <br><br>
                                    –û –≤–µ—â–∞—Ö, –∫–æ—Ç–æ—Ä—ã–µ —Å–ª—É—á–∞—Ç—Å—è —á–µ—Ä–µ–∑ 5 –ª–µ—Ç.
                                </div>
                            </div>
                        `;
                        break;
                }

                this.showLegendEnding('moshi_moshi', endingContent);
            }

            showLegendEnding(legendKey, content) {
                this.gameContent.innerHTML = `
                    <div class="chapter-container">
                        <div class="chapter-title">
                            <h2><span class="japanese-symbol">ÁµÇ</span>–§–ò–ù–ê–õ</h2>
                            <div class="subtitle">${this.legends[legendKey].title} –∑–∞–≤–µ—Ä—à—ë–Ω</div>
                        </div>

                        ${content}

                        <div style="text-align: center; margin: 20px 0; padding: 15px; background: rgba(255, 68, 68, 0.1); border-radius: 8px;">
                            <div style="color: var(--text-primary); margin-bottom: 10px;">
                                üèÜ –õ–ï–ì–ï–ù–î–ê –ò–ó–£–ß–ï–ù–ê
                            </div>
                            <div style="font-size: 11px; color: var(--text-secondary);">
                                –°—Ç—Ä–∞—Ö: ${this.fearLevel}% ‚Ä¢ –ü—Ä–æ–π–¥–µ–Ω–æ: ${this.gameState.completedLegends.length}/3
                            </div>
                        </div>
                    </div>
                `;

                const choices = [
                    {
                        text: 'üîÆ –î—Ä—É–≥–∏–µ –ª–µ–≥–µ–Ω–¥—ã –¢–æ–∫–∏–æ',
                        action: () => this.showLegendSelector(),
                        description: '–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å –Ω–æ–≤—ã–µ —Ç–∞–π–Ω—ã'
                    }
                ];

                if (this.gameState.completedLegends.length >= 2) {
                    choices.push({
                        text: 'üéì –ò–∑—É—á–∏—Ç—å —Ç–∞—Ç—É-–º–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ',
                        action: () => this.showCoursesOverview(),
                        description: '–û—Ç –º–∏—Å—Ç–∏–∫–∏ –∫ –∏—Å–∫—É—Å—Å—Ç–≤—É'
                    });
                }

                this.setChoices(choices);
            }

            // –û–ë–ó–û–† –ö–£–†–°–û–í (–ø–æ—è–≤–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ª–µ–≥–µ–Ω–¥)
            showCoursesOverview() {
                this.gameContent.innerHTML = `
                    <div>
                        <div style="text-align: center; margin-bottom: 25px;">
                            <h2 style="font-size: 18px; color: var(--text-primary);">
                                <span class="japanese-symbol">Â≠¶</span>–ê–ö–ê–î–ï–ú–ò–Ø –¢–ê–¢–£-–ú–ê–°–¢–ï–†–°–¢–í–ê
                            </h2>
                            <div style="font-size: 12px; color: var(--text-secondary);">
                                –û—Ç –≥–æ—Ä–æ–¥—Å–∫–∏—Ö –ª–µ–≥–µ–Ω–¥ –∫ —Å–æ–∑–∏–¥–∞—Ç–µ–ª—å–Ω–æ–º—É –∏—Å–∫—É—Å—Å—Ç–≤—É
                            </div>
                        </div>

                        <div class="story-log">
                            <div class="log-content">
                                –ü–æ–≥—Ä—É–∂–µ–Ω–∏–µ –≤ –º–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –¢–æ–∫–∏–æ –ø–æ–∫–∞–∑–∞–ª–æ —Ç—ë–º–Ω—É—é —Å—Ç–æ—Ä–æ–Ω—É –≥–æ—Ä–æ–¥–∞. 
                                –ù–æ –µ—Å—Ç—å –∏ —Å–≤–µ—Ç–ª–∞—è - –∏—Å–∫—É—Å—Å—Ç–≤–æ —Ç–∞—Ç—É–∏—Ä–æ–≤–∫–∏, –∫–æ—Ç–æ—Ä–æ–µ –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç —Å—Ç—Ä–∞—Ö–∏ –≤ –∫—Ä–∞—Å–æ—Ç—É.
                            </div>
                        </div>

                        <div style="background: linear-gradient(135deg, rgba(255, 68, 68, 0.1), rgba(68, 136, 255, 0.1)); border: 1px solid var(--text-primary); border-radius: 10px; padding: 20px; margin: 20px 0;">
                            <div style="font-size: 14px; font-weight: bold; margin-bottom: 15px; color: var(--text-primary); text-align: center;">
                                –î–û–°–¢–£–ü–ù–´–ï –ö–£–†–°–´:
                            </div>
                            
                            <div style="margin: 12px 0; padding: 15px; background: rgba(204, 0, 0, 0.1); border-radius: 8px;">
                                <div style="font-weight: bold;">–ü–æ–ª–Ω—ã–π –∫—É—Ä—Å —Ç–∞—Ç—É-–º–∞—Å—Ç–µ—Ä–∞</div>
                                <div style="font-size: 11px; margin: 5px 0;">–¢–µ–æ—Ä–∏—è + –≤–∏–¥–µ–æ + –Ω–∞—Å—Ç–∞–≤–Ω–∏—á–µ—Å—Ç–≤–æ ‚Ä¢ 1-2 –º–µ—Å—è—Ü–∞</div>
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <span style="text-decoration: line-through; opacity: 0.6;">45,000‚ÇΩ</span>
                                    <span style="font-size: 16px; font-weight: bold; color: var(--accent-blood);">22,500‚ÇΩ</span>
                                </div>
                            </div>

                            <div style="margin: 12px 0; padding: 15px; background: rgba(68, 136, 255, 0.1); border-radius: 8px;">
                                <div style="font-weight: bold;">SMM –¥–ª—è —Ç–∞—Ç—É-–º–∞—Å—Ç–µ—Ä–æ–≤</div>
                                <div style="font-size: 11px; margin: 5px 0;">Instagram, TikTok, –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ ‚Ä¢ 3 –Ω–µ–¥–µ–ª–∏</div>
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <span style="text-decoration: line-through; opacity: 0.6;">25,000‚ÇΩ</span>
                                    <span style="font-size: 16px; font-weight: bold; color: var(--accent-blue);">12,500‚ÇΩ</span>
                                </div>
                            </div>

                            <div style="margin: 12px 0; padding: 15px; background: rgba(255, 238, 238, 0.1); border-radius: 8px;">
                                <div style="font-weight: bold;">Procreate –¥–ª—è —ç—Å–∫–∏–∑–æ–≤</div>
                                <div style="font-size: 11px; margin: 5px 0;">–¶–∏—Ñ—Ä–æ–≤–æ–µ —Ä–∏—Å–æ–≤–∞–Ω–∏–µ —Ç–∞—Ç—É-—ç—Å–∫–∏–∑–æ–≤</div>
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <span style="text-decoration: line-through; opacity: 0.6;">15,000‚ÇΩ</span>
                                    <span style="font-size: 16px; font-weight: bold; color: var(--accent-pale);">7,500‚ÇΩ</span>
                                </div>
                            </div>
                        </div>

                        <div style="text-align: center; padding: 15px; background: var(--bg-secondary); border-radius: 8px; margin: 15px 0;">
                            <div style="color: var(--accent-blood); font-size: 14px; margin-bottom: 8px;">üéÅ –ü–†–û–ú–û–ö–û–î</div>
                            <div style="font-size: 20px; font-weight: bold; letter-spacing: 3px; color: var(--text-primary);">
                                LEGENDS50
                            </div>
                            <div style="font-size: 10px; margin-top: 5px; color: var(--text-secondary);">
                                –°–∫–∏–¥–∫–∞ 50% + –±–µ—Å–ø–ª–∞—Ç–Ω–∞—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è
                            </div>
                        </div>
                    </div>
                `;

                this.setChoices([
                    {
                        text: 'üìã –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥',
                        action: () => {
                            if (navigator.clipboard) {
                                navigator.clipboard.writeText('LEGENDS50');
                            }
                            this.showNotification('–ü—Ä–æ–º–æ–∫–æ–¥ LEGENDS50 —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω!');
                        },
                        description: '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞'
                    },
                    {
                        text: 'üí¨ –ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è —Å –º–∞—Å—Ç–µ—Ä–æ–º',
                        action: () => this.contactSupport(),
                        description: '–ü–æ–ª—É—á–∏—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—É—é –ø–æ–º–æ—â—å'
                    },
                    {
                        text: 'üëª –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –ª–µ–≥–µ–Ω–¥–∞–º',
                        action: () => this.showLegendSelector(),
                        description: '–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ'
                    }
                ]);
            }

            // –°–õ–£–ñ–ï–ë–ù–´–ï –ú–ï–¢–û–î–´
            updateFearLevel(level) {
                this.fearLevel = Math.min(100, level);
                const fill = document.getElementById('fearFill');
                if (fill) {
                    fill.style.width = this.fearLevel + '%';
                }
            }

            setChoices(choices) {
                this.choicesContainer.innerHTML = `
                    <div class="interaction-hint">–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:</div>
                    ${choices.map(choice => `
                        <button class="choice-button ${choice.dangerous ? 'dangerous' : ''}" data-action="${choice.text}">
                            ${choice.text}
                            ${choice.description ? `<div style="font-size: 10px; opacity: 0.7; margin-top: 5px;">${choice.description}</div>` : ''}
                        </button>
                    `).join('')}
                `;

                const buttons = this.choicesContainer.querySelectorAll('.choice-button');
                buttons.forEach((button, index) => {
                    button.onclick = choices[index].action;
                });
            }

            addCrawlingAnimation() {
                const crawler = document.createElement('div');
                crawler.className = 'crawling-animation';
                this.gameContent.appendChild(crawler);
                
                setTimeout(() => {
                    if (crawler.parentNode) crawler.remove();
                }, 6000);
            }

            playTekeSound() {
                const sound = document.getElementById('tekeSound');
                if (sound) {
                    sound.style.opacity = '1';
                    setTimeout(() => {
                        sound.style.opacity = '0';
                    }, 3000);
                }
            }

            makePhoneVibrate() {
                const phone = document.getElementById('phoneContainer');
                if (phone) {
                    phone.classList.add('phone-vibration');
                    setTimeout(() => {
                        phone.classList.remove('phone-vibration');
                    }, 2000);
                }
            }

            showJumpScare(text) {
                const scare = document.createElement('div');
                scare.style.cssText = `
                    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
                    background: var(--accent-blood); color: white; z-index: 10000;
                    display: flex; align-items: center; justify-content: center;
                    font-size: 18px; font-weight: bold; text-align: center;
                    animation: jumpScare 0.5s ease-out;
                `;
                scare.textContent = text;
                document.body.appendChild(scare);
                
                setTimeout(() => scare.remove(), 1500);
            }

            showNotification(text) {
                const notification = document.createElement('div');
                notification.style.cssText = `
                    position: fixed; top: 50px; right: 20px; 
                    background: var(--text-primary); color: black; 
                    padding: 12px 16px; border-radius: 8px; 
                    z-index: 1000; font-size: 12px;
                    box-shadow: 0 0 20px var(--glow-red);
                `;
                notification.textContent = text;
                document.body.appendChild(notification);
                setTimeout(() => notification.remove(), 3000);
            }

            getDifficultyLabel(difficulty) {
                const labels = {
                    'easy': 'üòå –õ–µ–≥–∫–æ',
                    'medium': 'üò∞ –°—Ä–µ–¥–Ω–µ', 
                    'hard': 'üò± –°–ª–æ–∂–Ω–æ',
                    'extreme': 'üíÄ –≠–∫—Å—Ç—Ä–∏–º'
                };
                return labels[difficulty] || '‚ùì –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ';
            }

            getEndingName(choice) {
                const names = {
                    'open': '–í—Å—Ç—Ä–µ—á–∞ —Å —Å—É–¥—å–±–æ–π',
                    'hide': '–í—Ä–µ–º–µ–Ω–Ω–æ–µ —Å–ø–∞—Å–µ–Ω–∏–µ',
                    'police': '–°–∫–µ–ø—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ',
                    'escape': '–ü—Ä–æ–∫–ª—è—Ç—ã–π –ø–æ–±–µ–≥',
                    'continue': '–ó–Ω–∞–Ω–∏–µ –±—É–¥—É—â–µ–≥–æ',
                    'hangup': '–ë–µ—Å–∫–æ–Ω–µ—á–Ω—ã–µ –∑–≤–æ–Ω–∫–∏',
                    'record': '–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞ –±–µ–∑—É–º–∏—è'
                };
                return names[choice] || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è —Å—É–¥—å–±–∞';
            }

            contactSupport() {
                if (tg) {
                    tg.openTelegramLink('https://t.me/your_tattoo_master');
                }
            }

            showDeviceInfo() {
                this.gameContent.innerHTML = `
                    <div>
                        <div style="text-align: center; margin-bottom: 20px;">
                            <h2 style="font-size: 16px; color: var(--accent-blue);">
                                <span class="japanese-symbol">Ê©ü</span>–ò–ù–§–û–†–ú–ê–¶–ò–Ø –û–ë –£–°–¢–†–û–ô–°–¢–í–ï
                            </h2>
                        </div>

                        <div class="story-log">
                            <div class="log-content">
                                <strong>–ú–æ–¥–µ–ª—å:</strong> DoCoMo FOMA P901i (2005)<br>
                                <strong>–í–ª–∞–¥–µ–ª–µ—Ü:</strong> –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ (–¥–∞–Ω–Ω—ã–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω—ã)<br>
                                <strong>–°—Ç–∞—Ç—É—Å:</strong> –ù–∞–π–¥–µ–Ω –≤ –¢–æ–∫–∏–æ<br>
                                <strong>–ü–∞–º—è—Ç—å:</strong> 100MB (–∞–Ω–æ–º–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)<br>
                                <strong>GPS:</strong> –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –º–µ—Å—Ç–∞<br>
                                <strong>–°–≤—è–∑—å:</strong> –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –∑–≤–æ–Ω–∫–∏ –∏–∑ –ø—Ä–æ—à–ª–æ–≥–æ
                            </div>
                        </div>

                        <div class="story-log corrupted">
                            <div class="log-content">
                                ‚ö†Ô∏è <strong>–ê–ù–û–ú–ê–õ–ò–ò:</strong><br>
                                ‚Ä¢ –ó–∞–ø–∏—Å–∏ –ø–æ—è–≤–ª—è—é—Ç—Å—è —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ<br>
                                ‚Ä¢ –ö–∞–º–µ—Ä–∞ —Å–Ω–∏–º–∞–µ—Ç –ø—Ä–∏–∑—Ä–∞–∫–æ–≤<br>
                                ‚Ä¢ –¢–µ–ª–µ—Ñ–æ–Ω –∑–≤–æ–Ω–∏—Ç –º—ë—Ä—Ç–≤—ã–º –ª—é–¥—è–º<br>
                                ‚Ä¢ –ë–∞—Ç–∞—Ä–µ—è –Ω–µ —Ä–∞–∑—Ä—è–∂–∞–µ—Ç—Å—è
                            </div>
                        </div>
                    </div>
                `;

                this.setChoices([
                    {
                        text: 'üëª –ö –≥–æ—Ä–æ–¥—Å–∫–∏–º –ª–µ–≥–µ–Ω–¥–∞–º',
                        action: () => this.showLegendSelector(),
                        description: '–ù–∞—á–∞—Ç—å –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ'
                    }
                ]);
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        let game;
        document.addEventListener('DOMContentLoaded', () => {
            game = new TokyoLegendsGame();
        });

        // –ê—Ç–º–æ—Å—Ñ–µ—Ä–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã
        setInterval(() => {
            if (Math.random() < 0.03) {
                document.body.style.filter = `hue-rotate(${Math.random() * 30}deg) contrast(${1.1 + Math.random() * 0.2})`;
                setTimeout(() => { document.body.style.filter = 'none'; }, 300);
            }
        }, 8000);

        // CSS –¥–ª—è –¥–∂–∞–º–ø-—Å–∫—ç—Ä–æ–≤
        const style = document.createElement('style');
        style.textContent = `
            @keyframes jumpScare {
                0% { opacity: 0; transform: scale(0.8); }
                50% { opacity: 1; transform: scale(1.2); }
                100% { opacity: 1; transform: scale(1); }
            }
            @keyframes phoneRingAnimation {
                0%, 100% { transform: scale(1); opacity: 1; }
                50% { transform: scale(1.2); opacity: 0.7; }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
