<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÁôΩÁü≥ÈöÜÊµ© | –£–ë–ò–ô–¶–ê –ò–ó TWITTER</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono:wght@400&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;700&display=swap');
        
        :root {
            --bg-dark: #0a0a0f;
            --bg-secondary: #1a1a2e;
            --text-primary: #00ffaa;
            --text-secondary: #666;
            --accent-pink: #ff0080;
            --accent-blue: #0099ff;
            --accent-purple: #8a2be2;
            --border-color: #333;
            --choice-bg: #001a0f;
            --choice-hover: #002a1f;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: var(--bg-dark);
            color: var(--text-primary);
            font-family: 'Share Tech Mono', 'Noto Sans JP', monospace;
            height: 100vh;
            overflow: hidden;
            position: relative;
        }

        /* Glitch —ç—Ñ—Ñ–µ–∫—Ç—ã –∫–∞–∫ –≤ 2005-2006 */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                repeating-linear-gradient(
                    0deg,
                    transparent,
                    transparent 2px,
                    rgba(0, 255, 170, 0.03) 2px,
                    rgba(0, 255, 170, 0.03) 4px
                );
            pointer-events: none;
            z-index: 1;
            animation: scanlines 2s linear infinite;
        }

        @keyframes scanlines {
            0% { transform: translateY(0); }
            100% { transform: translateY(4px); }
        }

        .phone-container {
            width: 400px;
            height: 780px;
            margin: 20px auto;
            background: linear-gradient(145deg, #2a2a2a, #1a1a1a);
            border: 3px solid #444;
            border-radius: 30px;
            padding: 18px;
            box-shadow: 
                0 0 60px var(--shadow-red),
                inset 0 0 30px rgba(0, 0, 0, 0.8);
            position: relative;
            z-index: 10;
            filter: contrast(1.2) brightness(0.9);
        }

        .phone-container::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                repeating-linear-gradient(
                    0deg,
                    transparent,
                    transparent 2px,
                    rgba(255, 255, 255, 0.03) 2px,
                    rgba(255, 255, 255, 0.03) 4px
                );
            pointer-events: none;
            border-radius: 30px;
        }

        .screen {
            width: 100%;
            height: 100%;
            background: var(--bg-primary);
            border-radius: 25px;
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .phone-header {
            background: var(--bg-tertiary);
            padding: 12px 18px;
            font-size: 11px;
            border-bottom: 1px solid #333;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .carrier-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .signal-bars {
            display: flex;
            gap: 2px;
        }

        .signal-bar {
            width: 3px;
            height: 8px;
            background: var(--text-primary);
            opacity: 0.4;
            transition: opacity 0.3s;
        }

        .signal-bar.active {
            opacity: 1;
            box-shadow: 0 0 5px var(--glow-orange);
        }

        .battery {
            color: var(--accent-blood);
            animation: batteryDrain 5s infinite;
        }

        @keyframes batteryDrain {
            0%, 60% { opacity: 1; }
            80%, 100% { opacity: 0.3; }
        }

        .content-area {
            flex: 1;
            padding: 20px 18px;
            overflow-y: auto;
            position: relative;
        }

        /* –ò–ù–î–ò–ö–ê–¢–û–†–´ –°–û–°–¢–û–Ø–ù–ò–Ø */
        .status-meters {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(0, 0, 0, 0.9);
            border: 1px solid #555;
            border-radius: 8px;
            padding: 12px;
            font-size: 10px;
            z-index: 100;
            min-width: 120px;
        }

        .meter {
            margin-bottom: 8px;
        }

        .meter-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 4px;
        }

        .meter-bar {
            width: 100px;
            height: 6px;
            background: #333;
            border-radius: 3px;
            overflow: hidden;
        }

        .meter-fill {
            height: 100%;
            transition: width 0.8s ease;
        }

        .fear-fill {
            background: linear-gradient(90deg, var(--text-primary), var(--accent-blood));
        }

        .sanity-fill {
            background: linear-gradient(90deg, var(--accent-purple), var(--accent-pale));
        }

        .progress-fill {
            background: linear-gradient(90deg, var(--accent-gold), var(--text-primary));
        }

        /* –ì–õ–ê–í–´ –ò –°–Æ–ñ–ï–¢ */
        .chapter-intro {
            text-align: center;
            margin-bottom: 30px;
            animation: fadeInUp 1s ease-out;
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .chapter-title {
            font-size: 20px;
            color: var(--accent-blood);
            margin-bottom: 10px;
            font-weight: bold;
        }

        .chapter-subtitle {
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        .chapter-location {
            font-size: 11px;
            color: var(--accent-gold);
        }

        .story-segment {
            background: rgba(255, 107, 53, 0.05);
            border: 1px solid rgba(255, 107, 53, 0.2);
            border-radius: 12px;
            padding: 18px;
            margin: 18px 0;
            position: relative;
            animation: segmentSlide 0.8s ease-out;
        }

        @keyframes segmentSlide {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .story-segment.corrupted {
            background: rgba(204, 0, 0, 0.1);
            border-color: var(--accent-blood);
            animation: segmentGlitch 0.4s ease-out;
        }

        @keyframes segmentGlitch {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-3px); }
            75% { transform: translateX(3px); }
        }

        .story-segment.memory {
            background: rgba(139, 79, 179, 0.1);
            border-color: var(--accent-purple);
        }

        .story-segment.discovery {
            background: rgba(255, 215, 0, 0.1);
            border-color: var(--accent-gold);
        }

        .segment-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            font-size: 11px;
            color: var(--text-secondary);
        }

        .segment-content {
            font-size: 14px;
            line-height: 1.6;
            margin-bottom: 12px;
        }

        .segment-timestamp {
            font-size: 10px;
            color: var(--text-secondary);
            text-align: right;
            opacity: 0.8;
        }

        .japanese-text {
            font-family: 'Noto Sans JP', sans-serif;
            font-weight: 300;
        }

        .japanese-symbol {
            font-family: 'Noto Sans JP', sans-serif;
            font-size: 24px;
            color: var(--accent-blood);
            display: inline-block;
            margin-right: 10px;
            animation: symbolGlow 4s infinite alternate;
        }

        @keyframes symbolGlow {
            from { 
                text-shadow: 0 0 10px var(--accent-blood);
                transform: scale(1);
            }
            to { 
                text-shadow: 0 0 25px var(--accent-blood), 0 0 35px var(--accent-blood);
                transform: scale(1.05);
            }
        }

        /* –ò–ù–¢–ï–†–ê–ö–¢–ò–í–ù–´–ï –≠–õ–ï–ú–ï–ù–¢–´ */
        .choice-section {
            background: var(--bg-secondary);
            border: 2px solid #555;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }

        .choice-title {
            color: var(--accent-gold);
            font-size: 14px;
            margin-bottom: 15px;
            text-align: center;
            font-weight: bold;
        }

        .choice-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
        }

        .choice-button {
            padding: 16px;
            background: linear-gradient(135deg, var(--bg-secondary), var(--bg-tertiary));
            border: 2px solid #666;
            border-radius: 10px;
            color: var(--text-primary);
            font-family: inherit;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.4s ease;
            text-align: left;
            position: relative;
            overflow: hidden;
        }

        .choice-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, var(--glow-orange), transparent);
            transition: left 0.6s;
        }

        .choice-button:hover::before {
            left: 100%;
        }

        .choice-button:hover {
            border-color: var(--text-primary);
            box-shadow: 0 0 20px var(--glow-orange);
            transform: translateY(-3px);
        }

        .choice-button.dangerous {
            border-color: var(--accent-blood);
            background: linear-gradient(135deg, rgba(204, 0, 0, 0.15), var(--bg-tertiary));
        }

        .choice-button.dangerous:hover {
            box-shadow: 0 0 25px rgba(204, 0, 0, 0.6);
        }

        .choice-button.special {
            border-color: var(--accent-gold);
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), var(--bg-tertiary));
        }

        .choice-description {
            font-size: 11px;
            opacity: 0.8;
            margin-top: 6px;
            font-style: italic;
        }

        /* –ú–ò–ù–ò-–ò–ì–†–´ */
        .mini-game {
            background: linear-gradient(135deg, var(--bg-secondary), var(--bg-tertiary));
            border: 2px solid var(--accent-purple);
            border-radius: 12px;
            padding: 22px;
            margin: 22px 0;
            text-align: center;
        }

        .game-title {
            color: var(--accent-purple);
            font-size: 15px;
            margin-bottom: 18px;
            font-weight: bold;
        }


        /* –ü–†–û–ì–†–ï–°–° –ò –ò–ù–î–ò–ö–ê–¢–û–†–´ */
        .progress-tracker {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 25px 0;
            flex-wrap: wrap;
        }

        .progress-chapter {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }

        .progress-dot {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: #444;
            border: 2px solid #666;
            transition: all 0.4s;
            position: relative;
        }

        .progress-dot.completed {
            background: var(--accent-blood);
            border-color: var(--accent-blood);
            box-shadow: 0 0 12px var(--accent-blood);
        }

        .progress-dot.active {
            background: var(--text-primary);
            border-color: var(--text-primary);
            animation: dotPulse 2s infinite;
        }

        @keyframes dotPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.3); }
        }

        .progress-label {
            font-size: 9px;
            color: var(--text-secondary);
            text-align: center;
        }

        .choices-container {
            padding: 18px;
            border-top: 1px solid #444;
            background: var(--bg-tertiary);
        }

        .interaction-hint {
            text-align: center;
            color: var(--accent-gold);
            font-size: 12px;
            margin-bottom: 15px;
            animation: hintPulse 3s infinite;
        }

        @keyframes hintPulse {
            0%, 100% { opacity: 0.7; }
            50% { opacity: 1; }
        }

        /* –°–ü–ï–¶–ò–ê–õ–¨–ù–´–ï –≠–§–§–ï–ö–¢–´ */
        .slit-mouth-animation {
            position: absolute;
            width: 60px;
            height: 40px;
            background: var(--accent-blood);
            border-radius: 50% 50% 20px 20px;
            opacity: 0.3;
            animation: slitMouthMove 8s linear infinite;
        }

        @keyframes slitMouthMove {
            0% { left: -60px; top: 20%; transform: scaleX(1); }
            25% { left: 25%; top: 10%; }
            50% { left: 50%; top: 30%; transform: scaleX(-1); }
            75% { left: 75%; top: 15%; }
            100% { left: calc(100% + 60px); top: 25%; transform: scaleX(-1); }
        }

        .mirror-effect {
            background: linear-gradient(45deg, 
                rgba(255, 215, 0, 0.1) 0%, 
                rgba(139, 79, 179, 0.1) 50%, 
                rgba(255, 215, 0, 0.1) 100%);
            border: 1px solid var(--accent-gold);
            animation: mirrorShimmer 3s infinite;
        }

        @keyframes mirrorShimmer {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .hidden { display: none; }
    </style>
</head>
<body>
    <div class="status-meters">
        <div class="meter">
            <div class="meter-label">
                <span class="japanese-text">ÊÅêÊÄñ</span>
                <span id="fearValue">0%</span>
            </div>
            <div class="meter-bar">
                <div class="meter-fill fear-fill" id="fearBar"></div>
            </div>
        </div>
        <div class="meter">
            <div class="meter-label">
                <span class="japanese-text">Ê≠£Ê∞ó</span>
                <span id="sanityValue">100%</span>
            </div>
            <div class="meter-bar">
                <div class="meter-fill sanity-fill" id="sanityBar" style="width: 100%;"></div>
            </div>
        </div>
        <div class="meter">
            <div class="meter-label">
                <span class="japanese-text">ÈÄ≤Ë°å</span>
                <span id="progressValue">0%</span>
            </div>
            <div class="meter-bar">
                <div class="meter-fill progress-fill" id="progressBar"></div>
            </div>
        </div>
    </div>

    <div class="phone-container">
        <div class="screen">
            <div class="phone-header">
                <div class="carrier-info">
                    <div class="signal-bars">
                        <div class="signal-bar active"></div>
                        <div class="signal-bar active"></div>
                        <div class="signal-bar"></div>
                        <div class="signal-bar"></div>
                    </div>
                    <span class="japanese-text" style="font-size: 10px;">NTT DoCoMo</span>
                </div>
                <div class="battery">04% ‚ö†Ô∏è</div>
            </div>

            <div id="gameContent" class="content-area">
                <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>

            <div id="choicesContainer" class="choices-container">
                <div class="interaction-hint japanese-text">Ëµ∑Âãï‰∏≠...</div>
            </div>
        </div>
    </div>

    <script>
        const tg = window.Telegram?.WebApp;
        if (tg) {
            tg.ready();
            tg.expand();
            tg.setHeaderColor('#0a0a0f');
            tg.setBackgroundColor('#0a0a0f');
        }

        class KuchisakeOnnaSaga {
            constructor() {
                this.gameContent = document.getElementById('gameContent');
                this.choicesContainer = document.getElementById('choicesContainer');
                
                this.gameState = {
                    chapter: 0,
                    fear: 0,
                    sanity: 100,
                    progress: 0,
                    playerName: '',
                    choices: [],
                    cluesFound: [],
                    secretsUnlocked: [],
                    mirrorsSeen: 0,
                    alliedWithSpirit: false,
                    knowsTruth: false,
                    hasAmulet: false,
                    survivedNight: false
                };

                this.chapters = [
                    { name: '–ü—Ä–æ–ª–æ–≥', label: '–ù–∞—Ö–æ–¥–∫–∞' },
                    { name: '–ì–ª–∞–≤–∞ 1', label: '–ü–µ—Ä–≤–∞—è –≤—Å—Ç—Ä–µ—á–∞' },
                    { name: '–ì–ª–∞–≤–∞ 2', label: '–ì–æ—Ä–æ–¥—Å–∫–∏–µ —Å–ª—É—Ö–∏' },
                    { name: '–ì–ª–∞–≤–∞ 3', label: '–ò—Å—Ç–æ—Ä–∏—è –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏—è' },
                    { name: '–ì–ª–∞–≤–∞ 4', label: '–ó–µ—Ä–∫–∞–ª—å–Ω—ã–π –º–∏—Ä' },
                    { name: '–ì–ª–∞–≤–∞ 5', label: '–ö–æ–Ω—Ñ—Ä–æ–Ω—Ç–∞—Ü–∏—è' },
                    { name: '–ì–ª–∞–≤–∞ 6', label: '–ü—Ä–∞–≤–¥–∞' },
                    { name: '–≠–ø–∏–ª–æ–≥', label: '–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è' }
                ];

                if (tg?.initDataUnsafe?.user) {
                    this.gameState.playerName = tg.initDataUnsafe.user.first_name || '–¢–∞–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å';
                }

                this.init();
            }

            init() {
                this.updateMeters();
                this.showPrologue();
            }

            showPrologue() {
                this.gameState.chapter = 0;
                this.updateProgress(5);
                
                this.gameContent.innerHTML = `
                    <div>
                        <div class="chapter-intro">
                            <div class="chapter-title">
                                <span class="japanese-symbol">ÁôΩ</span>–£–ë–ò–ô–¶–ê –ò–ó TWITTER
                            </div>
                            <div class="chapter-subtitle">–î–µ–ª–æ: –°–∏—Ä–∞–∏—Å–∏ –¢–∞–∫–∞—Ö–∏—Ä–æ (ÁôΩÁü≥ÈöÜÊµ©)</div>
                            <div class="chapter-location">–î–∑–∞–º–∞, –ö–∞–Ω–∞–≥–∞–≤–∞ ‚Ä¢ 2017 ‚Ä¢ Twitter DM</div>
                        </div>

                        <div class="story-segment">
                            <div class="segment-header">
                                <span>üì± –ù–∞–π–¥–µ–Ω–Ω—ã–π Twitter –∞–∫–∫–∞—É–Ω—Ç</span>
                                <span>31.10.2017</span>
                            </div>
                            <div class="segment-content">
                                –ü–æ–ª–∏—Ü–∏—è –æ–±–Ω–∞—Ä—É–∂–∏–ª–∞ –∞–∫—Ç–∏–≤–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç –≤ Twitter, –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—â–∏–π –°–∏—Ä–∞–∏—Å–∏ –¢–∞–∫–∞—Ö–∏—Ä–æ.
                                –ü—Ä–æ—Ñ–∏–ª—å –∑–∞–ø–æ–ª–Ω–µ–Ω —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –¥–ª—è –¥–µ–≤—É—à–µ–∫, –ø–ª–∞–Ω–∏—Ä—É—é—â–∏—Ö —Å–∞–º–æ—É–±–∏–π—Å—Ç–≤–æ.
                                <br><br>
                                @shiraishi_helper: "–ü–æ–º–æ–≥—É —É–π—Ç–∏ –±–µ–∑–±–æ–ª–µ–∑–Ω–µ–Ω–Ω–æ. –ù–µ –±—É–¥–µ—à—å –æ–¥–Ω–∞."
                                <br><br>
                                <span style="color: var(--accent-pink);">
                                9 —É–±–∏–π—Å—Ç–≤ –∑–∞ 2 –º–µ—Å—è—Ü–∞. –í–æ–∑—Ä–∞—Å—Ç –∂–µ—Ä—Ç–≤: 15-26 –ª–µ—Ç.
                                </span>
                            </div>
                        </div>

                        <div class="story-segment corrupted">
                            <div class="segment-header">
                                <span>‚ö†Ô∏è –ü–æ–ª–∏—Ü–µ–π—Å–∫–∏–π –æ—Ç—á—ë—Ç</span>
                                <span>–¢–æ–∫–∏–π—Å–∫–∞—è –ø–æ–ª–∏—Ü–∏—è</span>
                            </div>
                            <div class="segment-content">
                                –í–ù–ò–ú–ê–ù–ò–ï: –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –Ω–æ–≤–∞—è —Å—Ö–µ–º–∞ —É–±–∏–π—Å—Ç–≤ —á–µ—Ä–µ–∑ —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏.
                                –ü—Ä–µ—Å—Ç—É–ø–Ω–∏–∫ —ç–∫—Å–ø–ª—É–∞—Ç–∏—Ä—É–µ—Ç —Å—É–∏—Ü–∏–¥–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è –º–æ–ª–æ–¥—ë–∂–∏.
                                <br><br>
                                –°–∏—Ä–∞–∏—Å–∏ –ø—Ä–µ–¥–ª–∞–≥–∞–ª "–ø–æ–º–æ—â—å –≤ —Å—É–∏—Ü–∏–¥–µ", –Ω–æ –Ω–∞ –¥–µ–ª–µ –≥—Ä–∞–±–∏–ª –∏ —É–±–∏–≤–∞–ª –∂–µ—Ä—Ç–≤.
                                –í –¥–æ–º–µ –Ω–∞–π–¥–µ–Ω–æ 240+ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤ —á–µ–ª–æ–≤–µ—á–µ—Å–∫–∏—Ö –æ—Å—Ç–∞–Ω–∫–æ–≤ –≤ –º–æ—Ä–æ–∑–∏–ª—å–Ω–∏–∫–∞—Ö.
                                <br><br>
                                <span style="color: var(--accent-pink);">
                                –í–ø–µ—Ä–≤—ã–µ –≤ –∏—Å—Ç–æ—Ä–∏–∏: —Å–µ—Ä–∏–π–Ω—ã–π —É–±–∏–π—Ü–∞, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–π Twitter.
                                </span>
                            </div>
                        </div>

                        <div class="choice-section">
                            <div class="choice-title">üîç –ü–µ—Ä–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ</div>
                            <div class="choice-grid">
                                <button class="choice-button" onclick="game.makeChoice('start_careful')">
                                    üì± –ò–∑—É—á–∏—Ç—å Twitter –ø–µ—Ä–µ–ø–∏—Å–∫–∏
                                    <div class="choice-description">–ö–∞–∫ –°–∏—Ä–∞–∏—Å–∏ –∑–∞–º–∞–Ω–∏–≤–∞–ª –∂–µ—Ä—Ç–≤</div>
                                </button>
                                <button class="choice-button dangerous" onclick="game.makeChoice('start_deep')">
                                    üè† –û—Å–º–æ—Ç—Ä –¥–æ–º–∞ —É–±–∏–π—Ü—ã
                                    <div class="choice-description">240 —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤ –≤ –º–æ—Ä–æ–∑–∏–ª—å–Ω–∏–∫–∞—Ö</div>
                                </button>
                                <button class="choice-button" onclick="game.makeChoice('start_scientific')">
                                    üë§ –ü—Ä–æ—Ñ–∏–ª—å –∂–µ—Ä—Ç–≤
                                    <div class="choice-description">–ö–æ–≥–æ –≤—ã–±–∏—Ä–∞–ª –º–∞–Ω—å—è–∫</div>
                                </button>
                            </div>
                        </div>

                        ${this.renderProgressTracker()}
                    </div>
                `;

                this.setChoices([]);
            }

            makeChoice(choiceId, customData = null) {
                this.gameState.choices.push(choiceId);
                
                switch(choiceId) {
                    case 'start_careful':
                        this.updateFear(10);
                        this.updateSanity(-5);
                        this.showChapter1('careful');
                        break;
                    case 'start_deep':
                        this.updateFear(25);
                        this.updateSanity(-15);
                        this.showChapter1('deep');
                        break;
                    case 'start_scientific':
                        this.updateFear(5);
                        this.updateSanity(-2);
                        this.showChapter1('scientific');
                        break;
                    default:
                        this.handleSpecificChoice(choiceId, customData);
                }
            }

            showChapter1(approach) {
                this.gameState.chapter = 1;
                this.updateProgress(15);
                this.addSlitMouthAnimation();
                
                const approachText = {
                    'careful': '–¢—ã –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—à—å Twitter –ø–µ—Ä–µ–ø–∏—Å–∫–∏ –°–∏—Ä–∞–∏—Å–∏...',
                    'deep': '–¢—ã –≤—Ö–æ–¥–∏—à—å –≤ –¥–æ–º, –≥–¥–µ –Ω–∞—à–ª–∏ –æ—Å—Ç–∞–Ω–∫–∏...',
                    'scientific': '–¢—ã –∏–∑—É—á–∞–µ—à—å –ø—Ä–æ—Ñ–∏–ª–∏ –∂–µ—Ä—Ç–≤ —É–±–∏–π—Ü—ã...'
                };

                this.gameContent.innerHTML = `
                    <div>
                        <div class="chapter-intro">
                            <div class="chapter-title">
                                <span class="japanese-symbol">üì±</span>–¶–ò–§–†–û–í–û–ô –•–ò–©–ù–ò–ö
                            </div>
                            <div class="chapter-subtitle">–ì–ª–∞–≤–∞ 1: Twitter –∫–∞–∫ –æ—Ä—É–¥–∏–µ —É–±–∏–π—Å—Ç–≤–∞</div>
                            <div class="chapter-location">–î–∑–∞–º–∞, –ö–∞–Ω–∞–≥–∞–≤–∞ ‚Ä¢ –ö–≤–∞—Ä—Ç–∏—Ä–∞ –°–∏—Ä–∞–∏—Å–∏ ‚Ä¢ 2017</div>
                        </div>

                        <div class="story-segment">
                            <div class="segment-content">
                                ${approachText[approach]}
                            </div>
                        </div>

                        <div class="story-segment memory">
                            <div class="segment-header">
                                <span>üì± Twitter DM ‚Ä¢ @shiraishi_helper</span>
                                <span>22.08.2017</span>
                            </div>
                            <div class="segment-content">
                                <strong>–ü–æ—Å–ª–µ–¥–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–µ—Ä–≤–æ–π –∂–µ—Ä—Ç–≤—ã:</strong>
                                <br><br>
                                <em>–î–µ–≤—É—à–∫–∞, 21 –≥–æ–¥:</em> "–ë–æ–ª—å—à–µ –Ω–µ –º–æ–≥—É... —Ä–æ–¥–∏—Ç–µ–ª–∏ –Ω–µ –ø–æ–Ω–∏–º–∞—é—Ç..."
                                <br><br>
                                <em>–°–∏—Ä–∞–∏—Å–∏:</em> "–ü–æ–Ω–∏–º–∞—é —Ç–µ–±—è. –î–∞–≤–∞–π –≤—Å—Ç—Ä–µ—Ç–∏–º—Å—è. –ü–æ–º–æ–∂–µ–º –¥—Ä—É–≥ –¥—Ä—É–≥—É —É–π—Ç–∏ –∫—Ä–∞—Å–∏–≤–æ."
                                <br><br>
                                <span style="color: var(--accent-pink);">
                                –ß–µ—Ä–µ–∑ 3 —á–∞—Å–∞ –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–µ–≤—É—à–∫–∞ –±—ã–ª–∞ –º–µ—Ä—Ç–≤–∞.
                                360,000 –∏–µ–Ω —É–∫—Ä–∞–¥–µ–Ω–æ —Å –µ—ë –∫–∞—Ä—Ç—ã.
                                </span>
                            </div>
                        </div>

                        <div class="story-segment corrupted">
                            <div class="segment-header">
                                <span>üè† –ú–µ—Å—Ç–æ –ø—Ä–µ—Å—Ç—É–ø–ª–µ–Ω–∏–π</span>
                                <span>–î–∑–∞–º–∞ ‚Ä¢ –ö–≤–∞—Ä—Ç–∏—Ä–∞</span>
                            </div>
                            <div class="segment-content">
                                <strong>–°—Ö–µ–º–∞ —É–±–∏–π—Å—Ç–≤:</strong> –ü—Ä–∏–≥–ª–∞—à–∞–ª –≤ –∫–≤–∞—Ä—Ç–∏—Ä—É –ø–æ–¥ –ø—Ä–µ–¥–ª–æ–≥–æ–º "—Å–æ–≤–º–µ—Å—Ç–Ω–æ–≥–æ —Å—É–∏—Ü–∏–¥–∞".
                                <br><br>
                                <strong>–ú–µ—Ç–æ–¥—ã:</strong> –°–≤—è–∑—ã–≤–∞–Ω–∏–µ –∫–∞–±–µ–ª–µ–º, –∏–∑–Ω–∞—Å–∏–ª–æ–≤–∞–Ω–∏–µ, —É–¥—É—à–µ–Ω–∏–µ –≤–µ—Ä–µ–≤–∫–æ–π.
                                –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ - —Å–Ω–æ—Ç–≤–æ—Ä–Ω–æ–µ –≤ –Ω–∞–ø–∏—Ç–∫–µ.
                                <br><br>
                                <strong>–ü–æ—Å–ª–µ —É–±–∏–π—Å—Ç–≤–∞:</strong> –ì—Ä–∞–±—ë–∂, —Ä–∞—Å—á–ª–µ–Ω–µ–Ω–∏–µ —Ç–µ–ª–∞, –∑–∞–º–æ—Ä–æ–∑–∫–∞ –≤ —Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫–∞—Ö.
                                <br><br>
                                <span style="color: var(--accent-pink);">
                                240+ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤ —á–µ–ª–æ–≤–µ—á–µ—Å–∫–∏—Ö –æ—Å—Ç–∞–Ω–∫–æ–≤ –Ω–∞–π–¥–µ–Ω–æ –≤ –¥–æ–º–µ.
                                </span>
                            </div>
                        </div>

                        <div class="story-segment corrupted">
                            <div class="segment-header">
                                <span>‚öñÔ∏è –°–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –ø—Ä–∞–≤–æ—Å—É–¥–∏–µ</span>
                                <span>2017-2025</span>
                            </div>
                            <div class="segment-content">
                                –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç –¥–µ–ª –ø—Ä–æ—à–ª–æ–≥–æ, –°–∏—Ä–∞–∏—Å–∏ –±—ã–ª –ø–æ–π–º–∞–Ω –±—ã—Å—Ç—Ä–æ –±–ª–∞–≥–æ–¥–∞—Ä—è —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è–º.
                                <br><br>
                                <strong>–ö–∞–∫ –ø–æ–π–º–∞–ª–∏:</strong>
                                <br>‚Ä¢ –ö–∞–º–µ—Ä—ã –≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏—è –ø—Ä–æ—Å–ª–µ–¥–∏–ª–∏ –ø—É—Ç—å –ø–æ—Å–ª–µ–¥–Ω–µ–π –∂–µ—Ä—Ç–≤—ã
                                <br>‚Ä¢ –¶–∏—Ñ—Ä–æ–≤—ã–µ —Å–ª–µ–¥—ã –≤ Twitter –ø—Ä–∏–≤–µ–ª–∏ –∫ –¥–æ–º—É
                                <br>‚Ä¢ 31 –æ–∫—Ç—è–±—Ä—è 2017 - –∞—Ä–µ—Å—Ç
                                <br><br>
                                <span style="color: var(--accent-pink);">
                                15 –¥–µ–∫–∞–±—Ä—è 2020 - —Å–º–µ—Ä—Ç–Ω—ã–π –ø—Ä–∏–≥–æ–≤–æ—Ä.
                                27 –∏—é–Ω—è 2025 - –∫–∞–∑–Ω—å —á–µ—Ä–µ–∑ –ø–æ–≤–µ—à–µ–Ω–∏–µ.
                                </span>
                            </div>
                        </div>

                        <div class="choice-section">
                            <div class="choice-title">‚ö° –°–õ–ï–î–£–Æ–©–ò–ô –®–ê–ì</div>
                            <div class="choice-grid">
                                <button class="choice-button" onclick="game.showChapter2()">
                                    üîç –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ
                                    <div class="choice-description">–ò–∑—É—á–∏—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω—ã —É–±–∏–π—Å—Ç–≤</div>
                                </button>
                            </div>
                        </div>

                        ${this.renderProgressTracker()}
                    </div>
                `;

                this.setChoices([]);
            }

            showChapter2() {
                this.gameState.chapter = 2;
                this.updateProgress(35);
                
                this.gameContent.innerHTML = `
                    <div>
                        <div class="chapter-intro">
                            <div class="chapter-title">
                                <span class="japanese-symbol">ÂôÇ</span>–ì–û–†–û–î–°–ö–ò–ï –°–õ–£–•–ò
                            </div>
                            <div class="chapter-subtitle">–ì–ª–∞–≤–∞ 2: –≠–ø–∏–¥–µ–º–∏—è —Å—Ç—Ä–∞—Ö–∞</div>
                            <div class="chapter-location">–¢–æ–∫–∏–æ ‚Ä¢ –†–∞–∑–ª–∏—á–Ω—ã–µ —Ä–∞–π–æ–Ω—ã ‚Ä¢ 1980-1990</div>
                        </div>

                        <div class="story-segment corrupted">
                            <div class="segment-header">
                                <span>üì± –°–≤–æ–¥–∫–∞ –ø–æ–ª–∏—Ü–∏–∏</span>
                                <span>1980-1985</span>
                            </div>
                            <div class="segment-content">
                                –ó–∞ 5 –ª–µ—Ç –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–æ:
                                <br>‚Ä¢ 67 —Å–æ–æ–±—â–µ–Ω–∏–π –æ –≤—Å—Ç—Ä–µ—á–∞—Ö —Å "–∂–µ–Ω—â–∏–Ω–æ–π –≤ –º–∞—Å–∫–µ"
                                <br>‚Ä¢ 23 —Å–ª—É—á–∞—è –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏—è –¥–µ—Ç–µ–π
                                <br>‚Ä¢ 12 –Ω–∞–ø–∞–¥–µ–Ω–∏–π —Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º —Ä–µ–∂—É—â–∏—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤
                                <br><br>
                                <span style="color: var(--accent-blood);">
                                –í—Å–µ –ø–æ—Å—Ç—Ä–∞–¥–∞–≤—à–∏–µ –æ–ø–∏—Å—ã–≤–∞—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—É—é –∂–µ–Ω—â–∏–Ω—É.
                                </span>
                            </div>
                        </div>

                        <div class="story-segment">
                            <div class="segment-header">
                                <span>üì± –ò–Ω—Ç–µ—Ä–≤—å—é ‚Ä¢ –î–µ—Ç–µ–∫—Ç–∏–≤ –°–∞—Ç–æ</span>
                                <span>15.12.1988</span>
                            </div>
                            <div class="segment-content">
                                "–≠—Ç–æ –Ω–µ –æ–±—ã—á–Ω—ã–π –º–∞–Ω—å—è–∫. –°–≤–∏–¥–µ—Ç–µ–ª–∏ —É—Ç–≤–µ—Ä–∂–¥–∞—é—Ç, —á—Ç–æ –æ–Ω–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è 
                                –∏ –∏—Å—á–µ–∑–∞–µ—Ç –º–≥–Ω–æ–≤–µ–Ω–Ω–æ. –ö–∞–º–µ—Ä—ã –Ω–µ —Ñ–∏–∫—Å–∏—Ä—É—é—Ç –µ—ë –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ.
                                <br><br>
                                –ù–æ —Å–∞–º–æ–µ —Å—Ç—Ä–∞–Ω–Ω–æ–µ - –¥–µ—Ç–∏, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã–∂–∏–ª–∏, –≤—Å–µ —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞—é—Ç 
                                –æ–¥–Ω—É –∏—Å—Ç–æ—Ä–∏—é. –ü—Ä–æ –∂–µ–Ω—â–∏–Ω—É, –∫–æ—Ç–æ—Ä–∞—è —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç –ø—Ä–æ –∫—Ä–∞—Å–æ—Ç—É 
                                –∏ –Ω–æ—Å–∏—Ç —Ö–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫—É—é –º–∞—Å–∫—É."
                            </div>
                        </div>

                        <div class="choice-section">
                            <div class="choice-title">üó∫Ô∏è –ü–∞—Ç—Ç–µ—Ä–Ω –ø–æ—è–≤–ª–µ–Ω–∏–π</div>
                            <div class="choice-grid">
                                <button class="choice-button" onclick="game.makeChoice('investigate_schools')">
                                    üè´ –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å —à–∫–æ–ª—ã
                                    <div class="choice-description">–û–Ω–∞ —á–∞—â–µ –≤—Å–µ–≥–æ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤–æ–∑–ª–µ —É—á–µ–±–Ω—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π</div>
                                </button>
                                <button class="choice-button" onclick="game.makeChoice('investigate_mirrors')">
                                    ü™û –ù–∞–π—Ç–∏ –∑–µ—Ä–∫–∞–ª–∞
                                    <div class="choice-description">–°–≤–∏–¥–µ—Ç–µ–ª–∏ —É–ø–æ–º–∏–Ω–∞—é—Ç –æ—Ç—Ä–∞–∂–µ–Ω–∏—è</div>
                                </button>
                                <button class="choice-button dangerous" onclick="game.makeChoice('investigate_night')">
                                    üåô –ù–æ—á–Ω–æ–µ –ø–∞—Ç—Ä—É–ª–∏—Ä–æ–≤–∞–Ω–∏–µ
                                    <div class="choice-description">–ü–æ–ø—ã—Ç–∞—Ç—å—Å—è –≤—Å—Ç—Ä–µ—Ç–∏—Ç—å –µ—ë –ª–∏—á–Ω–æ</div>
                                </button>
                            </div>
                        </div>

                        ${this.renderProgressTracker()}
                    </div>
                `;

                this.setChoices([]);
            }

            handleSpecificChoice(choiceId, customData) {
                switch(choiceId) {
                    case 'investigate_schools':
                        this.updateFear(15);
                        this.updateSanity(-8);
                        this.showChapter3('schools');
                        break;
                    case 'investigate_mirrors':
                        this.updateFear(20);
                        this.updateSanity(-10);
                        this.gameState.mirrorsSeen++;
                        this.showChapter3('mirrors');
                        break;
                    case 'investigate_night':
                        this.updateFear(35);
                        this.updateSanity(-20);
                        this.showChapter3('night');
                        break;
                    case 'ally_with_spirit':
                        this.gameState.alliedWithSpirit = true;
                        this.updateFear(-10);
                        this.updateSanity(-25);
                        this.showChapter5();
                        break;
                    case 'seek_truth':
                        this.gameState.knowsTruth = true;
                        this.updateFear(10);
                        this.updateSanity(-5);
                        this.showChapter5();
                        break;
                    case 'get_amulet':
                        this.gameState.hasAmulet = true;
                        this.updateFear(-5);
                        this.showChapter5();
                        break;
                    default:
                        this.continueStory();
                }
            }

            showChapter3(path) {
                this.gameState.chapter = 3;
                this.updateProgress(50);
                
                const pathContent = {
                    'schools': {
                        title: '–®–ö–û–õ–¨–ù–´–ï –£–ñ–ê–°–´',
                        location: '–ù–∞—á–∞–ª—å–Ω–∞—è —à–∫–æ–ª–∞ –°–∏–±—É—è',
                        content: `
                            <div class="story-segment corrupted">
                                <div class="segment-header">
                                    <span>üì± –ó–∞–ø–∏—Å—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞ —à–∫–æ–ª—ã</span>
                                    <span>03.04.1983</span>
                                </div>
                                <div class="segment-content">
                                    –¢—Ä–µ—Ç–∏–π —Ä–µ–±—ë–Ω–æ–∫ –Ω–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ –ø—Ä–∏—à—ë–ª –¥–æ–º–æ–π —Å –ø–æ—Ä–µ–∑–∞–º–∏ –Ω–∞ –ª–∏—Ü–µ. 
                                    –í—Å–µ –≥–æ–≤–æ—Ä—è—Ç –ø—Ä–æ "–∫—Ä–∞—Å–∏–≤—É—é —Ç—ë—Ç—é —Å –º–∞—Å–∫–æ–π".
                                    <br><br>
                                    –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –æ—Å–≤–µ—â–µ–Ω–∏–µ –∏ –ø—Ä–æ—Å–∏–º —Ä–æ–¥–∏—Ç–µ–ª–µ–π 
                                    –∑–∞–±–∏—Ä–∞—Ç—å –¥–µ—Ç–µ–π –¥–æ –∑–∞–∫–∞—Ç–∞.
                                </div>
                            </div>
                        `
                    },
                    'mirrors': {
                        title: '–ó–ï–†–ö–ê–õ–¨–ù–´–ï –í–ò–î–ï–ù–ò–Ø',
                        location: '–¢–æ–∫–∏–π—Å–∫–∏–π –ø–∞—Ä–∫ ‚Ä¢ –û–±—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ç—É–∞–ª–µ—Ç—ã',
                        content: `
                            <div class="story-segment mirror-effect">
                                <div class="segment-header">
                                    <span>üì± –ü–æ–∫–∞–∑–∞–Ω–∏—è —É–±–æ—Ä—â–∏—Ü—ã</span>
                                    <span>17.09.1984</span>
                                </div>
                                <div class="segment-content">
                                    –í –∂–µ–Ω—Å–∫–æ–º —Ç—É–∞–ª–µ—Ç–µ —Ä–∞–∑–±–∏—Ç—ã –≤—Å–µ –∑–µ—Ä–∫–∞–ª–∞. –ö–∞–∂–¥—É—é –Ω–æ—á—å.
                                    <br><br>
                                    –°—Ç–∞–≤–ª—é –Ω–æ–≤—ã–µ - –∫ —É—Ç—Ä—É –æ—Å–∫–æ–ª–∫–∏. –ù–æ —Å–∞–º–æ–µ –∂—É—Ç–∫–æ–µ...
                                    –∏–Ω–æ–≥–¥–∞ –≤–∏–∂—É –≤ –æ—Ç—Ä–∞–∂–µ–Ω–∏–∏ –Ω–µ —Å–µ–±—è, –∞ –∂–µ–Ω—â–∏–Ω—É —Å —Ä–∞–∑—Ä–µ–∑–∞–Ω–Ω—ã–º —Ä—Ç–æ–º.
                                    <br><br>
                                    <span style="color: var(--accent-gold);">
                                    –û–Ω–∞ –º–∞—à–µ—Ç –º–Ω–µ –∏–∑ –∑–µ—Ä–∫–∞–ª–∞.
                                    </span>
                                </div>
                            </div>
                        `
                    },
                    'night': {
                        title: '–ù–û–ß–ù–ê–Ø –í–°–¢–†–ï–ß–ê',
                        location: '–£–ª–∏—Ü—ã –°–∏–±—É—è ‚Ä¢ 02:30',
                        content: `
                            <div class="story-segment corrupted">
                                <div class="segment-header">
                                    <span>üì± –õ–∏—á–Ω–∞—è –∑–∞–ø–∏—Å—å</span>
                                    <span>–°–ï–ô–ß–ê–°</span>
                                </div>
                                <div class="segment-content">
                                    –¢—ã –ø–∞—Ç—Ä—É–ª–∏—Ä—É–µ—à—å –ø—É—Å—Ç—ã–µ —É–ª–∏—Ü—ã. –í–Ω–µ–∑–∞–ø–Ω–æ —Å–ª—ã—à–∏—à—å —à–∞–≥–∏ –∑–∞ —Å–ø–∏–Ω–æ–π.
                                    <br><br>
                                    –û–±–æ—Ä–∞—á–∏–≤–∞–µ—à—å—Å—è - –∂–µ–Ω—â–∏–Ω–∞ –≤ –±–µ–ª–æ–º –ø–∞–ª—å—Ç–æ –∏ —Ö–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–æ–π –º–∞—Å–∫–µ.
                                    –û–Ω–∞ –º–µ–¥–ª–µ–Ω–Ω–æ –ø—Ä–∏–±–ª–∏–∂–∞–µ—Ç—Å—è.
                                    <br><br>
                                    <span style="color: var(--accent-blood);">
                                    "–í–∞—Ç–∞—à–∏ –∫–∏—Ä–µ–∏?" - –µ—ë –≥–æ–ª–æ—Å –∑–≤—É—á–∏—Ç –∫–∞–∫ —ç—Ö–æ.
                                    </span>
                                </div>
                            </div>
                        `
                    }
                };

                const content = pathContent[path];
                
                this.gameContent.innerHTML = `
                    <div>
                        <div class="chapter-intro">
                            <div class="chapter-title">
                                <span class="japanese-symbol">Ê∫ê</span>${content.title}
                            </div>
                            <div class="chapter-subtitle">–ì–ª–∞–≤–∞ 3: –ò—Å—Ç–æ—Ä–∏—è –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏—è</div>
                            <div class="chapter-location">${content.location}</div>
                        </div>

                        ${content.content}

                        <div class="story-segment discovery">
                            <div class="segment-header">
                                <span>üì± –ê—Ä—Ö–∏–≤–Ω–∞—è –Ω–∞—Ö–æ–¥–∫–∞</span>
                                <span>1978</span>
                            </div>
                            <div class="segment-content">
                                –í –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –∑–∞–ø–∏—Å—è—Ö –Ω–∞–π–¥–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–∞—Ü–∏–µ–Ω—Ç–∫–µ:
                                <br><br>
                                <strong>–Ø–º–∞–¥–∞ –ú–∏–∫–∏, 28 –ª–µ—Ç</strong>
                                <br>‚Ä¢ –ü–ª–∞—Å—Ç–∏—á–µ—Å–∫–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è –Ω–∞ –ª–∏—Ü–µ
                                <br>‚Ä¢ –ù–µ—É–¥–∞—á–Ω–æ–µ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–æ
                                <br>‚Ä¢ –ü—Å–∏—Ö–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –ø–æ—Å–ª–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
                                <br>‚Ä¢ –ò—Å—á–µ–∑–ª–∞ –∏–∑ –±–æ–ª—å–Ω–∏—Ü—ã 31.10.1978
                                <br><br>
                                <span style="color: var(--accent-gold);">
                                –ü–µ—Ä–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ "–∫—É—á–∏—Å–∞–∫—ç-–æ–Ω–Ω–∞" –ø–æ—è–≤–∏–ª–∏—Å—å 1 –Ω–æ—è–±—Ä—è 1978.
                                </span>
                            </div>
                        </div>

                        ${this.renderChapter4Choices()}
                        ${this.renderProgressTracker()}
                    </div>
                `;

                this.setChoices([]);
            }

            renderChapter4Choices() {
                return `
                    <div class="choice-section">
                        <div class="choice-title">üí≠ –ü–æ–Ω–∏–º–∞–Ω–∏–µ –∏—Å—Ç–∏–Ω—ã</div>
                        <div class="choice-grid">
                            <button class="choice-button special" onclick="game.makeChoice('ally_with_spirit')">
                                ü§ù –ü–æ–ø—ã—Ç–∞—Ç—å—Å—è –ø–æ–º–æ—á—å –¥—É—Ö—É
                                <div class="choice-description">–û–Ω–∞ –∂–µ—Ä—Ç–≤–∞, –∞ –Ω–µ –º–æ–Ω—Å—Ç—Ä</div>
                            </button>
                            <button class="choice-button" onclick="game.makeChoice('seek_truth')">
                                üîç –ù–∞–π—Ç–∏ –ø–æ–ª–Ω—É—é –ø—Ä–∞–≤–¥—É
                                <div class="choice-description">–ò–∑—É—á–∏—Ç—å –≤—Å–µ –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞</div>
                            </button>
                            <button class="choice-button" onclick="game.makeChoice('get_amulet')">
                                üõ°Ô∏è –ù–∞–π—Ç–∏ –∑–∞—â–∏—Ç—É
                                <div class="choice-description">–ü–æ–ª—É—á–∏—Ç—å –¥—É—Ö–æ–≤–Ω—ã–π –∞–º—É–ª–µ—Ç</div>
                            </button>
                        </div>
                    </div>
                `;
            }

            showChapter5() {
                this.gameState.chapter = 5;
                this.updateProgress(75);
                
                this.gameContent.innerHTML = `
                    <div>
                        <div class="chapter-intro">
                            <div class="chapter-title">
                                <span class="japanese-symbol">ÂØæ</span>–ö–û–ù–§–†–û–ù–¢–ê–¶–ò–Ø
                            </div>
                            <div class="chapter-subtitle">–ì–ª–∞–≤–∞ 5: –õ–∏—Ü–æ–º –∫ –ª–∏—Ü—É</div>
                            <div class="chapter-location">–ó–∞–±—Ä–æ—à–µ–Ω–Ω–∞—è –±–æ–ª—å–Ω–∏—Ü–∞ ‚Ä¢ –ü–æ–ª–Ω–æ—á—å</div>
                        </div>

                        <div class="story-segment corrupted">
                            <div class="segment-content">
                                –¢—ã –ø—Ä–∏—Ö–æ–¥–∏—à—å –≤ —Ç—É —Å–∞–º—É—é –±–æ–ª—å–Ω–∏—Ü—É, –≥–¥–µ –≤—Å—ë –Ω–∞—á–∞–ª–æ—Å—å. 
                                –ö–æ—Ä–∏–¥–æ—Ä—ã –ø—É—Å—Ç—ã, –Ω–æ —Ç—ã —á—É–≤—Å—Ç–≤—É–µ—à—å –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ.
                                <br><br>
                                –í –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Ç–µ–±—è –∂–¥—ë—Ç –æ–Ω–∞. –ú–∏–∫–∏ –Ø–º–∞–¥–∞.
                                –ö—É—á–∏—Å–∞–∫—ç-–æ–Ω–Ω–∞.
                            </div>
                        </div>

                        ${this.renderFinalEncounter()}
                        ${this.renderProgressTracker()}
                    </div>
                `;

                this.setChoices([]);
            }

            renderFinalEncounter() {
                if (this.gameState.alliedWithSpirit) {
                    return `
                        <div class="story-segment memory">
                            <div class="segment-content">
                                "–¢—ã... –ø–æ–Ω–∏–º–∞–µ—à—å –º–µ–Ω—è?" - –µ—ë –≥–æ–ª–æ—Å –¥—Ä–æ–∂–∏—Ç.
                                <br><br>
                                –ë–µ–∑ –º–∞—Å–∫–∏ –æ–Ω–∞ –≤—ã–≥–ª—è–¥–∏—Ç –ø–µ—á–∞–ª—å–Ω–æ. –®—Ä–∞–º—ã —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞—é—Ç 
                                –∏—Å—Ç–æ—Ä–∏—é –±–æ–ª–∏ –∏ –æ—Ç—á–∞—è–Ω–∏—è.
                                <br><br>
                                "–Ø –ø—Ä–æ—Å—Ç–æ —Ö–æ—Ç–µ–ª–∞ –±—ã—Ç—å –∫—Ä–∞—Å–∏–≤–æ–π..."
                            </div>
                        </div>
                        <div class="choice-section">
                            <div class="choice-title">üíñ –ú–æ–º–µ–Ω—Ç —Å–æ—á—É–≤—Å—Ç–≤–∏—è</div>
                            <div class="choice-grid">
                                <button class="choice-button special" onclick="game.showEnding('redemption')">
                                    ‚ú® –ü–æ–º–æ—á—å –µ–π –Ω–∞–π—Ç–∏ –ø–æ–∫–æ–π
                                </button>
                            </div>
                        </div>
                    `;
                } else if (this.gameState.knowsTruth) {
                    return `
                        <div class="story-segment discovery">
                            <div class="segment-content">
                                –¢—ã –∑–Ω–∞–µ—à—å –ø—Ä–∞–≤–¥—É. –û–Ω–∞ –Ω–µ –º–æ–Ω—Å—Ç—Ä - –æ–Ω–∞ –∂–µ—Ä—Ç–≤–∞ —Å–∏—Å—Ç–µ–º—ã –∫—Ä–∞—Å–æ—Ç—ã, 
                                –∫–æ—Ç–æ—Ä–∞—è –¥–æ–≤–µ–ª–∞ –µ—ë –¥–æ –æ—Ç—á–∞—è–Ω–∏—è.
                                <br><br>
                                "–í–∞—Ç–∞—à–∏ –∫–∏—Ä–µ–∏?" - —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç –æ–Ω–∞ –≤ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞–∑.
                            </div>
                        </div>
                        <div class="choice-section">
                            <div class="choice-title">üí¨ –ü–æ—Å–ª–µ–¥–Ω–∏–π –æ—Ç–≤–µ—Ç</div>
                            <div class="choice-grid">
                                <button class="choice-button" onclick="game.showEnding('truth')">
                                    "–ö—Ä–∞—Å–æ—Ç–∞ –Ω–µ –≤ –ª–∏—Ü–µ"
                                </button>
                                <button class="choice-button dangerous" onclick="game.showEnding('lie')">
                                    "–î–∞, —Ç—ã –∫—Ä–∞—Å–∏–≤–∞—è"
                                </button>
                            </div>
                        </div>
                    `;
                } else {
                    return `
                        <div class="story-segment corrupted">
                            <div class="segment-content">
                                –û–Ω–∞ –ø—Ä–∏–±–ª–∏–∂–∞–µ—Ç—Å—è —Å –Ω–æ–∂–Ω–∏—Ü–∞–º–∏ –≤ —Ä—É–∫–µ.
                                <br><br>
                                "–í–∞—Ç–∞—à–∏ –∫–∏—Ä–µ–∏?"
                                <br><br>
                                –£ —Ç–µ–±—è –µ—Å—Ç—å ${this.gameState.hasAmulet ? '–∞–º—É–ª–µ—Ç' : '—Ç–æ–ª—å–∫–æ —Å–ª–æ–≤–∞'}.
                            </div>
                        </div>
                        <div class="choice-section">
                            <div class="choice-title">‚öîÔ∏è –ó–∞—â–∏—Ç–∞</div>
                            <div class="choice-grid">
                                ${this.gameState.hasAmulet ? `
                                    <button class="choice-button special" onclick="game.showEnding('protected')">
                                        üõ°Ô∏è –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–º—É–ª–µ—Ç
                                    </button>
                                ` : ''}
                                <button class="choice-button" onclick="game.showEnding('word_trick')">
                                    üèÉ‚Äç‚ôÇÔ∏è –¢–∏—Ö–æ –æ—Ç—Å—Ç—É–ø–∏—Ç—å
                                </button>
                                <button class="choice-button dangerous" onclick="game.showEnding('fight')">
                                    ‚öîÔ∏è –ü–æ–ø—ã—Ç–∞—Ç—å—Å—è –¥—Ä–∞—Ç—å—Å—è
                                </button>
                            </div>
                        </div>
                    `;
                }
            }

            showEnding(endingType) {
                this.gameState.chapter = 7;
                this.updateProgress(100);
                
                const endings = {
                    'redemption': {
                        title: '–ò–°–ö–£–ü–õ–ï–ù–ò–ï',
                        content: `
                            <div class="story-segment special">
                                <div class="segment-content">
                                    –¢–≤–æ—ë —Å–æ—á—É–≤—Å—Ç–≤–∏–µ —Ä–∞–∑—Ä—É—à–∞–µ—Ç –ø—Ä–æ–∫–ª—è—Ç–∏–µ. –ú–∏–∫–∏ –ø–ª–∞—á–µ—Ç - –ø–µ—Ä–≤—ã–µ 
                                    —Å–ª—ë–∑—ã –∑–∞ 27 –ª–µ—Ç —Å—Ç—Ä–∞–¥–∞–Ω–∏–π.
                                    <br><br>
                                    "–°–ø–∞—Å–∏–±–æ... —á—Ç–æ —É–≤–∏–¥–µ–ª –≤–æ –º–Ω–µ —á–µ–ª–æ–≤–µ–∫–∞."
                                    <br><br>
                                    –û–Ω–∞ –∏—Å—á–µ–∑–∞–µ—Ç –≤ —Å–≤–µ—Ç–ª–æ–º —Å–∏—è–Ω–∏–∏. –ö—É—á–∏—Å–∞–∫—ç-–æ–Ω–Ω–∞ –±–æ–ª—å—à–µ 
                                    –Ω–µ –±—É–¥–µ—Ç –ø—Ä–µ—Å–ª–µ–¥–æ–≤–∞—Ç—å –¥–µ—Ç–µ–π.
                                    <br><br>
                                    <span style="color: var(--accent-gold);">
                                    –ò—Å—Ç–æ—Ä–∏—è –ú–∏–∫–∏ –Ω–∞—Ö–æ–¥–∏—Ç –ø–æ–∫–æ–π.
                                    </span>
                                </div>
                            </div>
                        `,
                        outcome: '–õ—É—á—à–∞—è –∫–æ–Ω—Ü–æ–≤–∫–∞'
                    },
                    'truth': {
                        title: '–ì–û–†–¨–ö–ê–Ø –ü–†–ê–í–î–ê',
                        content: `
                            <div class="story-segment discovery">
                                <div class="segment-content">
                                    "–ö—Ä–∞—Å–æ—Ç–∞ –Ω–µ –≤ –ª–∏—Ü–µ, –∞ –≤ –¥—É—à–µ," - –≥–æ–≤–æ—Ä–∏—à—å —Ç—ã.
                                    <br><br>
                                    –û–Ω–∞ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è. –î–æ–ª–≥–∞—è –ø–∞—É–∑–∞.
                                    <br><br>
                                    "–ù–æ... –º–æ—è –¥—É—à–∞ —Ç–æ–∂–µ –∏—Å–∫–∞–ª–µ—á–µ–Ω–∞," - —à–µ–ø—á–µ—Ç –æ–Ω–∞ –∏ –∏—Å—á–µ–∑–∞–µ—Ç.
                                    <br><br>
                                    –ù–∞–ø–∞–¥–µ–Ω–∏—è –ø—Ä–µ–∫—Ä–∞—â–∞—é—Ç—Å—è, –Ω–æ –¥—É—Ö –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç –ø–æ–∫–æ—è.
                                </div>
                            </div>
                        `,
                        outcome: '–ß–∞—Å—Ç–∏—á–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ'
                    },
                    'protected': {
                        title: '–ó–ê–©–ò–©–Å–ù–ù–´–ô',
                        content: `
                            <div class="story-segment">
                                <div class="segment-content">
                                    –ê–º—É–ª–µ—Ç —Å–≤–µ—Ç–∏—Ç—Å—è —è—Ä–∫–∏–º —Å–≤–µ—Ç–æ–º. –ö—É—á–∏—Å–∞–∫—ç-–æ–Ω–Ω–∞ –æ—Ç—Å—Ç—É–ø–∞–µ—Ç.
                                    <br><br>
                                    "–¢—ã... –ø–æ–¥–≥–æ—Ç–æ–≤–∏–ª—Å—è," - –≥–æ–≤–æ—Ä–∏—Ç –æ–Ω–∞ —Å —É–≤–∞–∂–µ–Ω–∏–µ–º.
                                    <br><br>
                                    –û–Ω–∞ –∏—Å—á–µ–∑–∞–µ—Ç, –Ω–æ —Ç—ã –∑–Ω–∞–µ—à—å - –æ–Ω–∞ –≤–µ—Ä–Ω—ë—Ç—Å—è –∫ —Ç–µ–º, 
                                    –∫—Ç–æ –Ω–µ –≥–æ—Ç–æ–≤ –≤—Å—Ç—Ä–µ—Ç–∏—Ç—å –µ—ë.
                                </div>
                            </div>
                        `,
                        outcome: '–õ–∏—á–Ω–æ–µ —Å–ø–∞—Å–µ–Ω–∏–µ'
                    },
                    'word_trick': {
                        title: '–°–¢–ê–†–´–ô –¢–†–Æ–ö',
                        content: `
                            <div class="story-segment">
                                <div class="segment-content">
                                    "–ü–æ–º–∞–¥–∞," - –±—ã—Å—Ç—Ä–æ –æ—Ç–≤–µ—á–∞–µ—à—å —Ç—ã.
                                    <br><br>
                                    –û–Ω–∞ –∑–∞–º–∏—Ä–∞–µ—Ç, —Ä–∞—Å—Ç–µ—Ä—è–Ω–Ω–∞—è. –°–ª–æ–≤–æ —Å–±–∏–≤–∞–µ—Ç –µ—ë —Å —Ç–æ–ª–∫—É.
                                    <br><br>
                                    –ü–æ–∫–∞ –æ–Ω–∞ –¥—É–º–∞–µ—Ç, —Ç—ã —É–±–µ–≥–∞–µ—à—å. –î—Ä–µ–≤–Ω–∏–π —Ç—Ä—é–∫ —Å—Ä–∞–±–æ—Ç–∞–ª.
                                    <br><br>
                                    –ù–æ –ø—Ä–æ–±–ª–µ–º–∞ –Ω–µ —Ä–µ—à–µ–Ω–∞. –û–Ω–∞ –Ω–∞–π–¥—ë—Ç –¥—Ä—É–≥–∏—Ö –∂–µ—Ä—Ç–≤.
                                </div>
                            </div>
                        `,
                        outcome: '–í—Ä–µ–º–µ–Ω–Ω–æ–µ —Å–ø–∞—Å–µ–Ω–∏–µ'
                    },
                    'fight': {
                        title: '–ù–ï–£–î–ê–ß–ù–ê–Ø –ü–û–ü–´–¢–ö–ê',
                        content: `
                            <div class="story-segment corrupted">
                                <div class="segment-content">
                                    –¢—ã –ø—ã—Ç–∞–µ—à—å—Å—è —Å–±–µ–∂–∞—Ç—å, –Ω–æ –æ–Ω–∞ –±—ã—Å—Ç—Ä–µ–µ.
                                    <br><br>
                                    "–¢–µ–ø–µ—Ä—å —Ç—ã –±—É–¥–µ—à—å –∫—Ä–∞—Å–∏–≤—ã–º... –∫–∞–∫ —è."
                                    <br><br>
                                    <span style="color: var(--accent-blood);">
                                    –•–æ–ª–æ–¥ –Ω–æ–∂–Ω–∏—Ü –∫–∞—Å–∞–µ—Ç—Å—è —Ç–≤–æ–µ–≥–æ –ª–∏—Ü–∞...
                                    </span>
                                </div>
                            </div>
                        `,
                        outcome: '–ü–ª–æ—Ö–∞—è –∫–æ–Ω—Ü–æ–≤–∫–∞'
                    }
                };

                const ending = endings[endingType];
                
                this.gameContent.innerHTML = `
                    <div>
                        <div class="chapter-intro">
                            <div class="chapter-title">
                                <span class="japanese-symbol">ÁµÇ</span>${ending.title}
                            </div>
                            <div class="chapter-subtitle">–≠–ø–∏–ª–æ–≥: ${ending.outcome}</div>
                        </div>

                        ${ending.content}

                        <div style="margin: 30px 0; padding: 20px; background: rgba(255, 107, 53, 0.1); border-radius: 12px; text-align: center;">
                            <div style="color: var(--accent-gold); font-size: 16px; margin-bottom: 15px;">
                                üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê –ü–†–û–•–û–ñ–î–ï–ù–ò–Ø
                            </div>
                            <div style="font-size: 12px; color: var(--text-secondary); line-height: 1.6;">
                                –°—Ç—Ä–∞—Ö: ${this.gameState.fear}% ‚Ä¢ –†–∞—Å—Å—É–¥–æ–∫: ${this.gameState.sanity}%<br>
                                –£–ª–∏–∫ –Ω–∞–π–¥–µ–Ω–æ: ${this.gameState.cluesFound.length}<br>
                                –°–µ–∫—Ä–µ—Ç–æ–≤ –æ—Ç–∫—Ä—ã—Ç–æ: ${this.gameState.secretsUnlocked.length}<br>
                                –ö–æ–Ω—Ü–æ–≤–∫–∞: ${ending.outcome}
                            </div>
                        </div>

                        <div style="text-align: center; margin: 20px 0; padding: 15px; background: rgba(139, 79, 179, 0.1); border-radius: 8px;">
                            <div style="color: var(--accent-purple); margin-bottom: 10px;">
                                üí≠ –ü–û–°–õ–ï–°–õ–û–í–ò–ï
                            </div>
                            <div style="font-size: 13px;">
                                –ò—Å—Ç–æ—Ä–∏—è –ö—É—á–∏—Å–∞–∫—ç-–æ–Ω–Ω–∞ –Ω–∞–ø–æ–º–∏–Ω–∞–µ—Ç –Ω–∞–º –æ –≤–∞–∂–Ω–æ—Å—Ç–∏ —Å–æ—á—É–≤—Å—Ç–≤–∏—è 
                                –∏ –ø–æ–Ω–∏–º–∞–Ω–∏—è –∏—Å—Ç–∏–Ω–Ω–æ–π –∫—Ä–∞—Å–æ—Ç—ã. 
                                <br><br>
                                –í–æ–∑–º–æ–∂–Ω–æ, –ø–æ—Ä–∞ –∏–∑—É—á–∏—Ç—å –∏—Å–∫—É—Å—Å—Ç–≤–æ, –∫–æ—Ç–æ—Ä–æ–µ –ø–æ–º–æ–≥–∞–µ—Ç –ª—é–¥—è–º 
                                —á—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å —Å–µ–±—è –∫—Ä–∞—Å–∏–≤—ã–º–∏?
                            </div>
                        </div>

                        ${this.renderProgressTracker()}
                    </div>
                `;

                this.setChoices([
                    {
                        text: 'üîÑ –ü—Ä–æ–π—Ç–∏ —Å–Ω–æ–≤–∞',
                        action: () => location.reload(),
                        description: '–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –¥—Ä—É–≥–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã'
                    },
                    {
                        text: 'üéì –ò–∑—É—á–∏—Ç—å —Ç–∞—Ç—É-–º–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ',
                        action: () => this.showCoursesOverview(),
                        description: '–ò—Å–∫—É—Å—Å—Ç–≤–æ –Ω–∞—Å—Ç–æ—è—â–µ–π –∫—Ä–∞—Å–æ—Ç—ã'
                    },
                    {
                        text: 'üì± –ü–æ–¥–µ–ª–∏—Ç—å—Å—è –∏—Å—Ç–æ—Ä–∏–µ–π',
                        action: () => this.shareStory(),
                        description: '–†–∞—Å—Å–∫–∞–∑–∞—Ç—å –¥—Ä—É–∑—å—è–º'
                    }
                ]);
            }

            showCoursesOverview() {
                this.gameContent.innerHTML = `
                    <div>
                        <div style="text-align: center; margin-bottom: 25px;">
                            <h2 style="font-size: 20px; color: var(--text-primary);">
                                <span class="japanese-symbol">Áæé</span>–ê–ö–ê–î–ï–ú–ò–Ø –ö–†–ê–°–û–¢–´
                            </h2>
                            <div style="font-size: 13px; color: var(--text-secondary);">
                                –¢–∞—Ç—É-–º–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ ‚Ä¢ –ù–∞—Å—Ç–æ—è—â–∞—è –∫—Ä–∞—Å–æ—Ç–∞ –∏–∑–Ω—É—Ç—Ä–∏
                            </div>
                        </div>

                        <div class="story-segment">
                            <div class="segment-content">
                                –ò—Å—Ç–æ—Ä–∏—è –ú–∏–∫–∏ –Ø–º–∞–¥–∞ –ø–æ–∫–∞–∑–∞–ª–∞, –∫–∞–∫ —Å—Ç—Ä–µ–º–ª–µ–Ω–∏–µ –∫ –≤–Ω–µ—à–Ω–µ–π –∫—Ä–∞—Å–æ—Ç–µ 
                                –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å –ø—Ä–æ–∫–ª—è—Ç–∏–µ–º. –ù–æ –µ—Å—Ç—å –∏—Å–∫—É—Å—Å—Ç–≤–æ, –∫–æ—Ç–æ—Ä–æ–µ –ø–æ–º–æ–≥–∞–µ—Ç 
                                –ª—é–¥—è–º –≤—ã—Ä–∞–∑–∏—Ç—å —Å–≤–æ—é –≤–Ω—É—Ç—Ä–µ–Ω–Ω—é—é –∫—Ä–∞—Å–æ—Ç—É - —Ç–∞—Ç—É–∏—Ä–æ–≤–∫–∏.
                            </div>
                        </div>

                        <div style="background: linear-gradient(135deg, rgba(255, 107, 53, 0.1), rgba(139, 79, 179, 0.1)); border: 2px solid var(--text-primary); border-radius: 15px; padding: 22px; margin: 22px 0;">
                            <div style="font-size: 16px; font-weight: bold; margin-bottom: 18px; color: var(--text-primary); text-align: center;">
                                –î–û–°–¢–£–ü–ù–´–ï –ö–£–†–°–´:
                            </div>
                            
                            <div style="margin: 15px 0; padding: 18px; background: rgba(204, 0, 0, 0.1); border-radius: 10px;">
                                <div style="font-weight: bold; font-size: 15px;">–ü–æ–ª–Ω—ã–π –∫—É—Ä—Å —Ç–∞—Ç—É-–º–∞—Å—Ç–µ—Ä–∞</div>
                                <div style="font-size: 12px; margin: 8px 0;">–ü–æ–ª–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –∏—Å–∫—É—Å—Å—Ç–≤—É —Ç–∞—Ç—É–∏—Ä–æ–≤–∫–∏ –æ—Ç –æ—Å–Ω–æ–≤ –¥–æ –º–∞—Å—Ç–µ—Ä—Å—Ç–≤–∞</div>
                                <div style="font-size: 11px; margin: 5px 0; color: var(--text-secondary);">–¢–µ–æ—Ä–∏—è + –≤–∏–¥–µ–æ + –Ω–∞—Å—Ç–∞–≤–Ω–∏—á–µ—Å—Ç–≤–æ ‚Ä¢ 1-2 –º–µ—Å—è—Ü–∞</div>
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 10px;">
                                    <span style="text-decoration: line-through; opacity: 0.6; font-size: 14px;">45,000‚ÇΩ</span>
                                    <span style="font-size: 18px; font-weight: bold; color: var(--accent-blood);">22,500‚ÇΩ</span>
                                </div>
                            </div>

                            <div style="margin: 15px 0; padding: 18px; background: rgba(139, 79, 179, 0.1); border-radius: 10px;">
                                <div style="font-weight: bold; font-size: 15px;">SMM –¥–ª—è —Ç–∞—Ç—É-–º–∞—Å—Ç–µ—Ä–æ–≤</div>
                                <div style="font-size: 12px; margin: 8px 0;">–°–æ–∑–¥–∞–π –±—Ä–µ–Ω–¥, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–º–æ–≥–∞–µ—Ç –ª—é–¥—è–º —á—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å —Å–µ–±—è –∫—Ä–∞—Å–∏–≤—ã–º–∏</div>
                                <div style="font-size: 11px; margin: 5px 0; color: var(--text-secondary);">Instagram, TikTok, –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ ‚Ä¢ 3 –Ω–µ–¥–µ–ª–∏</div>
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 10px;">
                                    <span style="text-decoration: line-through; opacity: 0.6; font-size: 14px;">25,000‚ÇΩ</span>
                                    <span style="font-size: 18px; font-weight: bold; color: var(--accent-purple);">12,500‚ÇΩ</span>
                                </div>
                            </div>

                            <div style="margin: 15px 0; padding: 18px; background: rgba(255, 215, 0, 0.1); border-radius: 10px;">
                                <div style="font-weight: bold; font-size: 15px;">Procreate –¥–ª—è —ç—Å–∫–∏–∑–æ–≤</div>
                                <div style="font-size: 12px; margin: 8px 0;">–¶–∏—Ñ—Ä–æ–≤–æ–µ –∏—Å–∫—É—Å—Å—Ç–≤–æ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Ç–∞—Ç—É-–¥–∏–∑–∞–π–Ω–æ–≤</div>
                                <div style="font-size: 11px; margin: 5px 0; color: var(--text-secondary);">–†–∏—Å–æ–≤–∞–Ω–∏–µ –≤ iPad ‚Ä¢ –ì–∏–±–∫–∏–π –≥—Ä–∞—Ñ–∏–∫</div>
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 10px;">
                                    <span style="text-decoration: line-through; opacity: 0.6; font-size: 14px;">15,000‚ÇΩ</span>
                                    <span style="font-size: 18px; font-weight: bold; color: var(--accent-gold);">7,500‚ÇΩ</span>
                                </div>
                            </div>
                        </div>

                        <div style="text-align: center; padding: 20px; background: var(--bg-secondary); border-radius: 12px; margin: 20px 0;">
                            <div style="color: var(--accent-blood); font-size: 16px; margin-bottom: 10px;">üéÅ –ü–†–û–ú–û–ö–û–î</div>
                            <div style="font-size: 24px; font-weight: bold; letter-spacing: 4px; color: var(--text-primary);">
                                BEAUTY50
                            </div>
                            <div style="font-size: 11px; margin-top: 8px; color: var(--text-secondary);">
                                –°–∫–∏–¥–∫–∞ 50% + –±–µ—Å–ø–ª–∞—Ç–Ω–∞—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è<br>
                                –í –ø–∞–º—è—Ç—å –æ –ú–∏–∫–∏ –Ø–º–∞–¥–∞
                            </div>
                        </div>
                    </div>
                `;

                this.setChoices([
                    {
                        text: 'üìã –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥ BEAUTY50',
                        action: () => {
                            if (navigator.clipboard) {
                                navigator.clipboard.writeText('BEAUTY50');
                            }
                            this.showNotification('–ü—Ä–æ–º–æ–∫–æ–¥ BEAUTY50 —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω!');
                        },
                        description: '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞'
                    },
                    {
                        text: 'üí¨ –ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è —Å –º–∞—Å—Ç–µ—Ä–æ–º',
                        action: () => this.contactSupport(),
                        description: '–ü–æ–ª—É—á–∏—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—É—é –ø–æ–º–æ—â—å'
                    },
                    {
                        text: 'üîÑ –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –∏—Å—Ç–æ—Ä–∏–∏',
                        action: () => location.reload(),
                        description: '–ü—Ä–æ–π—Ç–∏ —Å–∞–≥—É –∑–∞–Ω–æ–≤–æ'
                    }
                ]);
            }

            // –°–õ–£–ñ–ï–ë–ù–´–ï –ú–ï–¢–û–î–´
            updateFear(delta) {
                this.gameState.fear = Math.max(0, Math.min(100, this.gameState.fear + delta));
                this.updateMeters();
            }

            updateSanity(delta) {
                this.gameState.sanity = Math.max(0, Math.min(100, this.gameState.sanity + delta));
                this.updateMeters();
            }

            updateProgress(value) {
                this.gameState.progress = value;
                this.updateMeters();
            }

            updateMeters() {
                document.getElementById('fearValue').textContent = this.gameState.fear + '%';
                document.getElementById('fearBar').style.width = this.gameState.fear + '%';
                
                document.getElementById('sanityValue').textContent = this.gameState.sanity + '%';
                document.getElementById('sanityBar').style.width = this.gameState.sanity + '%';
                
                document.getElementById('progressValue').textContent = this.gameState.progress + '%';
                document.getElementById('progressBar').style.width = this.gameState.progress + '%';
            }

            renderProgressTracker() {
                return `
                    <div class="progress-tracker">
                        ${this.chapters.map((chapter, index) => `
                            <div class="progress-chapter">
                                <div class="progress-dot ${index < this.gameState.chapter ? 'completed' : index === this.gameState.chapter ? 'active' : ''}"></div>
                                <div class="progress-label">${chapter.label}</div>
                            </div>
                        `).join('')}
                    </div>
                `;
            }


            addSlitMouthAnimation() {
                const animation = document.createElement('div');
                animation.className = 'slit-mouth-animation';
                animation.style.top = Math.random() * 200 + 'px';
                this.gameContent.appendChild(animation);
                
                setTimeout(() => {
                    if (animation.parentNode) animation.remove();
                }, 8000);
            }

            setChoices(choices) {
                if (choices.length === 0) return;
                
                this.choicesContainer.innerHTML = `
                    <div class="interaction-hint">–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:</div>
                    ${choices.map(choice => `
                        <button class="choice-button ${choice.dangerous ? 'dangerous' : choice.special ? 'special' : ''}" data-action="${choice.text}">
                            ${choice.text}
                            ${choice.description ? `<div class="choice-description">${choice.description}</div>` : ''}
                        </button>
                    `).join('')}
                `;

                const buttons = this.choicesContainer.querySelectorAll('.choice-button');
                buttons.forEach((button, index) => {
                    button.onclick = choices[index].action;
                });
            }

            showNotification(text) {
                const notification = document.createElement('div');
                notification.style.cssText = `
                    position: fixed; top: 60px; right: 20px; 
                    background: var(--text-primary); color: black; 
                    padding: 12px 16px; border-radius: 8px; 
                    z-index: 1000; font-size: 12px; font-weight: bold;
                    box-shadow: 0 0 20px var(--glow-orange);
                `;
                notification.textContent = text;
                document.body.appendChild(notification);
                setTimeout(() => notification.remove(), 3000);
            }

            shareStory() {
                if (tg) {
                    tg.switchInlineQuery('–ü—Ä–æ—à–ª–∞ —ç–ø–∏—á–µ—Å–∫—É—é —Å–∞–≥—É –æ –ö—É—á–∏—Å–∞–∫—ç-–æ–Ω–Ω–∞! 8 –≥–ª–∞–≤ —è–ø–æ–Ω—Å–∫–æ–≥–æ —Ö–æ—Ä—Ä–æ—Ä–∞ üëªü™û');
                }
            }

            contactSupport() {
                if (tg) {
                    tg.openTelegramLink('https://t.me/your_beauty_support');
                }
            }

            continueStory() {
                // –†–µ–∑–µ—Ä–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è
                this.showChapter5();
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
        let game;
        document.addEventListener('DOMContentLoaded', () => {
            game = new KuchisakeOnnaSaga();
            window.game = game; // –î–µ–ª–∞–µ–º –æ–±—ä–µ–∫—Ç game –¥–æ—Å—Ç—É–ø–Ω—ã–º –≥–ª–æ–±–∞–ª—å–Ω–æ
        });

        // –ê—Ç–º–æ—Å—Ñ–µ—Ä–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã
        setInterval(() => {
            if (Math.random() < 0.04) {
                document.body.style.filter = `hue-rotate(${Math.random() * 45}deg) contrast(${1.1 + Math.random() * 0.3})`;
                setTimeout(() => { document.body.style.filter = 'none'; }, 400);
            }
        }, 12000);

        // –≠—Ñ—Ñ–µ–∫—Ç –º–µ—Ä—Ü–∞–Ω–∏—è —è–ø–æ–Ω—Å–∫–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤
        setInterval(() => {
            const symbols = document.querySelectorAll('.japanese-symbol');
            symbols.forEach(symbol => {
                if (Math.random() < 0.1) {
                    symbol.style.opacity = Math.random() > 0.5 ? '1' : '0.6';
                    setTimeout(() => { symbol.style.opacity = '1'; }, 200);
                }
            });
        }, 3000);
    </script>
</body>
</html>
